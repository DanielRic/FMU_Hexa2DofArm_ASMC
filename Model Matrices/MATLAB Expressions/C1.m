C14=(1/2).*(2.*dth.*cos(psi).*cos(th).*(L.*(ml1+ml2).*sin(phi)+(c1.*ml1+l1.* ...
  ml2).*sin(phi+q1)+c2.*ml2.*sin(phi+q1+q2))+c2.*dq2.*ml2.*(cos(phi+(-1).* ...
  psi+q1+q2)+(-1).*cos(phi+psi+q1+q2)+2.*cos(psi).*cos(phi+q1+q2).*sin(th) ...
  )+2.*dq1.*cos(q1).*(cos(phi).*(c2.*ml2.*sin(psi).*sin(q2)+cos(psi).*( ...
  c1.*ml1+l1.*ml2+c2.*ml2.*cos(q2)).*sin(th))+sin(phi).*((c1.*ml1+l1.*ml2+ ...
  c2.*ml2.*cos(q2)).*sin(psi)+(-1).*c2.*ml2.*cos(psi).*sin(q2).*sin(th)))+ ...
  (-2).*dq1.*sin(q1).*(sin(phi).*(c2.*ml2.*sin(psi).*sin(q2)+cos(psi).*( ...
  c1.*ml1+l1.*ml2+c2.*ml2.*cos(q2)).*sin(th))+cos(phi).*((-1).*(c1.*ml1+ ...
  l1.*ml2+c2.*ml2.*cos(q2)).*sin(psi)+c2.*ml2.*cos(psi).*sin(q2).*sin(th)) ...
  )+dphi.*(2.*cos(phi).*(sin(psi).*((c1.*ml1+l1.*ml2).*sin(q1)+c2.*ml2.* ...
  sin(q1+q2))+cos(psi).*(L.*(ml1+ml2)+(c1.*ml1+l1.*ml2).*cos(q1)+c2.*ml2.* ...
  cos(q1+q2)).*sin(th))+2.*sin(phi).*((L.*(ml1+ml2)+(c1.*ml1+l1.*ml2).* ...
  cos(q1)+c2.*ml2.*cos(q1+q2)).*sin(psi)+(-1).*cos(psi).*((c1.*ml1+l1.* ...
  ml2).*sin(q1)+c2.*ml2.*sin(q1+q2)).*sin(th)))+dpsi.*(2.*sin(phi).*(cos( ...
  psi).*((c1.*ml1+l1.*ml2).*sin(q1)+c2.*ml2.*sin(q1+q2))+(-1).*(L.*(ml1+ ...
  ml2)+(c1.*ml1+l1.*ml2).*cos(q1)+c2.*ml2.*cos(q1+q2)).*sin(psi).*sin(th)) ...
  +(-2).*cos(phi).*(cos(psi).*(L.*(ml1+ml2)+(c1.*ml1+l1.*ml2).*cos(q1)+ ...
  c2.*ml2.*cos(q1+q2))+sin(psi).*((c1.*ml1+l1.*ml2).*sin(q1)+c2.*ml2.*sin( ...
  q1+q2)).*sin(th))));
C15=dpsi.*(L.*(ml1+ml2).*cos(phi)+(c1.*ml1+l1.*ml2).*cos(phi+q1)+c2.*ml2.* ...
  cos(phi+q1+q2)).*cos(th).*sin(psi)+c2.*dq2.*ml2.*cos(psi).*cos(th).*sin( ...
  phi+q1+q2)+dq1.*cos(psi).*cos(th).*((c1.*ml1+l1.*ml2).*sin(phi+q1)+c2.* ...
  ml2.*sin(phi+q1+q2))+dphi.*cos(psi).*cos(th).*(L.*(ml1+ml2).*sin(phi)+( ...
  c1.*ml1+l1.*ml2).*sin(phi+q1)+c2.*ml2.*sin(phi+q1+q2))+dth.*cos(psi).*( ...
  L.*(ml1+ml2).*cos(phi)+(c1.*ml1+l1.*ml2).*cos(phi+q1)+c2.*ml2.*cos(phi+ ...
  q1+q2)).*sin(th);
C16=(1/2).*(2.*dth.*(L.*(ml1+ml2).*cos(phi)+(c1.*ml1+l1.*ml2).*cos(phi+q1)+ ...
  c2.*ml2.*cos(phi+q1+q2)).*cos(th).*sin(psi)+(-2).*c2.*dq2.*ml2.*(sin(q1+ ...
  q2).*((-1).*cos(psi).*sin(phi)+cos(phi).*sin(psi).*sin(th))+cos(q1+q2).* ...
  (cos(phi).*cos(psi)+sin(phi).*sin(psi).*sin(th)))+(-2).*dq1.*((-1).*(( ...
  c1.*ml1+l1.*ml2).*sin(q1)+c2.*ml2.*sin(q1+q2)).*(cos(psi).*sin(phi)+(-1) ...
  .*cos(phi).*sin(psi).*sin(th))+(c1.*ml1+l1.*ml2).*cos(q1).*(cos(phi).* ...
  cos(psi)+sin(phi).*sin(psi).*sin(th))+c2.*ml2.*cos(q1+q2).*(cos(phi).* ...
  cos(psi)+sin(phi).*sin(psi).*sin(th)))+dpsi.*(2.*cos(phi).*(sin(psi).*(( ...
  c1.*ml1+l1.*ml2).*sin(q1)+c2.*ml2.*sin(q1+q2))+cos(psi).*(L.*(ml1+ml2)+( ...
  c1.*ml1+l1.*ml2).*cos(q1)+c2.*ml2.*cos(q1+q2)).*sin(th))+(-2).*sin(phi) ...
  .*((-1).*(L.*(ml1+ml2)+(c1.*ml1+l1.*ml2).*cos(q1)+c2.*ml2.*cos(q1+q2)).* ...
  sin(psi)+cos(psi).*((c1.*ml1+l1.*ml2).*sin(q1)+c2.*ml2.*sin(q1+q2)).* ...
  sin(th)))+dphi.*(2.*sin(phi).*(cos(psi).*((c1.*ml1+l1.*ml2).*sin(q1)+ ...
  c2.*ml2.*sin(q1+q2))+(-1).*(L.*(ml1+ml2)+(c1.*ml1+l1.*ml2).*cos(q1)+c2.* ...
  ml2.*cos(q1+q2)).*sin(psi).*sin(th))+(-2).*cos(phi).*(cos(psi).*(L.*( ...
  ml1+ml2)+(c1.*ml1+l1.*ml2).*cos(q1)+c2.*ml2.*cos(q1+q2))+sin(psi).*(( ...
  c1.*ml1+l1.*ml2).*sin(q1)+c2.*ml2.*sin(q1+q2)).*sin(th))));
C17=(1/2).*(cos(psi).*(dth.*(c1.*ml1+l1.*ml2).*cos(q1).*cos(th).*sin(phi)+ ...
  c2.*dth.*ml2.*cos(q1+q2).*cos(th).*sin(phi)+2.*c1.*dpsi.*ml1.*sin(phi).* ...
  sin(q1)+2.*dpsi.*l1.*ml2.*sin(phi).*sin(q1)+c1.*dth.*ml1.*cos(th).*sin( ...
  phi+q1)+dth.*l1.*ml2.*cos(th).*sin(phi+q1)+2.*c2.*dpsi.*ml2.*sin(phi).* ...
  sin(q1+q2)+c2.*dth.*ml2.*cos(th).*sin(phi+q1+q2)+(-2).*c1.*dphi.*ml1.* ...
  sin(phi).*sin(q1).*sin(th)+(-2).*c1.*dq1.*ml1.*sin(phi).*sin(q1).*sin( ...
  th)+(-2).*dphi.*l1.*ml2.*sin(phi).*sin(q1).*sin(th)+(-2).*dq1.*l1.*ml2.* ...
  sin(phi).*sin(q1).*sin(th)+(-2).*c2.*dphi.*ml2.*sin(phi).*sin(q1+q2).* ...
  sin(th)+(-2).*c2.*dq1.*ml2.*sin(phi).*sin(q1+q2).*sin(th)+(-2).*c2.* ...
  dq2.*ml2.*sin(phi).*sin(q1+q2).*sin(th))+2.*sin(phi).*sin(psi).*((c1.* ...
  ml1+l1.*ml2).*cos(q1).*(dphi+dq1+(-1).*dpsi.*sin(th))+c2.*ml2.*cos(q1+ ...
  q2).*(dphi+dq1+dq2+(-1).*dpsi.*sin(th)))+cos(phi).*(cos(psi).*(c1.*dth.* ...
  ml1.*cos(th).*sin(q1)+dth.*l1.*ml2.*cos(th).*sin(q1)+c2.*dth.*ml2.*cos( ...
  th).*sin(q1+q2)+(-1).*c2.*dphi.*ml2.*sin(q1).*sin(q2).*sin(th)+(-1).* ...
  c2.*ml2.*cos(q1+q2).*(2.*dpsi+(-1).*(dphi+2.*(dq1+dq2)).*sin(th))+cos( ...
  q1).*((-2).*dpsi.*(c1.*ml1+l1.*ml2)+(2.*(dphi+dq1).*(c1.*ml1+l1.*ml2)+ ...
  c2.*dphi.*ml2.*cos(q2)).*sin(th)))+sin(psi).*(c2.*ml2.*(dphi.*cos(q1).* ...
  sin(q2)+sin(q1+q2).*(dphi+2.*(dq1+dq2)+(-2).*dpsi.*sin(th)))+sin(q1).*( ...
  c2.*dphi.*ml2.*cos(q2)+2.*(c1.*ml1+l1.*ml2).*(dphi+dq1+(-1).*dpsi.*sin( ...
  th))))));
C18=(1/2).*c2.*ml2.*(2.*cos(q1+q2).*sin(phi).*sin(psi).*(dphi+dq1+dq2+(-1).* ...
  dpsi.*sin(th))+cos(psi).*(dth.*cos(q1+q2).*cos(th).*sin(phi)+dth.*cos( ...
  th).*sin(phi+q1+q2)+2.*sin(phi).*sin(q1+q2).*(dpsi+(-1).*(dphi+dq1+dq2) ...
  .*sin(th)))+cos(phi).*(2.*sin(psi).*sin(q1+q2).*(dphi+dq1+dq2+(-1).* ...
  dpsi.*sin(th))+cos(psi).*(dth.*cos(th).*sin(q1+q2)+2.*cos(q1+q2).*((-1) ...
  .*dpsi+(dphi+dq1+dq2).*sin(th)))));
