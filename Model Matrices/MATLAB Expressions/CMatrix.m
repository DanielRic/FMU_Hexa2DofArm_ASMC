function CM = CMatrix(xi, dxi, HexaConstants, ArmConstants)

ml1 = ArmConstants.Mass1;
ml2 = ArmConstants.Mass2;

L   = ArmConstants.Hexa_to_joint_L;

l1  = ArmConstants.l1_dim(1);

c1  = ArmConstants.MC1;
c2  = ArmConstants.MC2;

Hb = HexaConstants.Inertia;
Hbx = Hb(1, 1); Hby = Hb(2, 2); Hbz = Hb(3, 3);

H1 = ArmConstants.Inertia1;
H1xx = H1(1, 1); H1yy = H1(2, 2); H1zz = H1(3, 3);

H2 = ArmConstants.Inertia2;
H2xx = H2(1, 1); H2yy = H2(2, 2); H2zz = H2(3, 3);

phi = xi(4);
th  = xi(5);
psi = xi(6);
q1  = xi(7);
q2  = xi(8);
            
dphi = dxi(4);
dth  = dxi(5);
dpsi = dxi(6);
dq1  = dxi(7);
dq2  = dxi(8);

[C14, C15, C16, C17, C18] = get_C1();
[C24, C25, C26, C27, C28] = get_C2();
[C34, C35, C36, C37, C38] = get_C3();
[C44, C45, C46, C47, C48] = get_C4();
[C54, C55, C56, C57, C58] = get_C5();
[C64, C65, C66, C67, C68] = get_C6();
[C74, C75, C76, C77, C78] = get_C7();
[C84, C85, C86, C87, C88] = get_C8();

C11_83 = zeros(8, 3);
C14_88 = [C14, C15, C16, C17, C18;...
          C24, C25, C26, C27, C28;...
          C34, C35, C36, C37, C38;...
          C44, C45, C46, C47, C48;...
          C54, C55, C56, C57, C58;...
          C64, C65, C66, C67, C68;...
          C74, C75, C76, C77, C78;...
          C84, C85, C86, C87, C88];

CM = [C11_83, C14_88];

function [C14, C15, C16, C17, C18] = get_C1()
C14=(1/2)*(2*dth*cos(psi)*cos(th)*(L*(ml1+ml2)*sin(phi)+(c1*ml1+l1* ...
  ml2)*sin(phi+q1)+c2*ml2*sin(phi+q1+q2))+c2*dq2*ml2*(cos(phi- ...
  psi+q1+q2)-cos(phi+psi+q1+q2)+2*cos(psi)*cos(phi+q1+q2)*sin(th) ...
  )+2*dq1*cos(q1)*(cos(phi)*(c2*ml2*sin(psi)*sin(q2)+cos(psi)*( ...
  c1*ml1+l1*ml2+c2*ml2*cos(q2))*sin(th))+sin(phi)*((c1*ml1+l1*ml2+ ...
  c2*ml2*cos(q2))*sin(psi)-c2*ml2*cos(psi)*sin(q2)*sin(th)))+ ...
  (-2)*dq1*sin(q1)*(sin(phi)*(c2*ml2*sin(psi)*sin(q2)+cos(psi)*( ...
  c1*ml1+l1*ml2+c2*ml2*cos(q2))*sin(th))+cos(phi)*(-(c1*ml1+ ...
  l1*ml2+c2*ml2*cos(q2))*sin(psi)+c2*ml2*cos(psi)*sin(q2)*sin(th)) ...
  )+dphi*(2*cos(phi)*(sin(psi)*((c1*ml1+l1*ml2)*sin(q1)+c2*ml2* ...
  sin(q1+q2))+cos(psi)*(L*(ml1+ml2)+(c1*ml1+l1*ml2)*cos(q1)+c2*ml2* ...
  cos(q1+q2))*sin(th))+2*sin(phi)*((L*(ml1+ml2)+(c1*ml1+l1*ml2)* ...
  cos(q1)+c2*ml2*cos(q1+q2))*sin(psi)-cos(psi)*((c1*ml1+l1* ...
  ml2)*sin(q1)+c2*ml2*sin(q1+q2))*sin(th)))+dpsi*(2*sin(phi)*(cos( ...
  psi)*((c1*ml1+l1*ml2)*sin(q1)+c2*ml2*sin(q1+q2))-(L*(ml1+ ...
  ml2)+(c1*ml1+l1*ml2)*cos(q1)+c2*ml2*cos(q1+q2))*sin(psi)*sin(th)) ...
  +(-2)*cos(phi)*(cos(psi)*(L*(ml1+ml2)+(c1*ml1+l1*ml2)*cos(q1)+ ...
  c2*ml2*cos(q1+q2))+sin(psi)*((c1*ml1+l1*ml2)*sin(q1)+c2*ml2*sin( ...
  q1+q2))*sin(th))));
C15=dpsi*(L*(ml1+ml2)*cos(phi)+(c1*ml1+l1*ml2)*cos(phi+q1)+c2*ml2* ...
  cos(phi+q1+q2))*cos(th)*sin(psi)+c2*dq2*ml2*cos(psi)*cos(th)*sin( ...
  phi+q1+q2)+dq1*cos(psi)*cos(th)*((c1*ml1+l1*ml2)*sin(phi+q1)+c2* ...
  ml2*sin(phi+q1+q2))+dphi*cos(psi)*cos(th)*(L*(ml1+ml2)*sin(phi)+( ...
  c1*ml1+l1*ml2)*sin(phi+q1)+c2*ml2*sin(phi+q1+q2))+dth*cos(psi)*( ...
  L*(ml1+ml2)*cos(phi)+(c1*ml1+l1*ml2)*cos(phi+q1)+c2*ml2*cos(phi+ ...
  q1+q2))*sin(th);
C16=(1/2)*(2*dth*(L*(ml1+ml2)*cos(phi)+(c1*ml1+l1*ml2)*cos(phi+q1)+ ...
  c2*ml2*cos(phi+q1+q2))*cos(th)*sin(psi)+(-2)*c2*dq2*ml2*(sin(q1+ ...
  q2)*(-cos(psi)*sin(phi)+cos(phi)*sin(psi)*sin(th))+cos(q1+q2)* ...
  (cos(phi)*cos(psi)+sin(phi)*sin(psi)*sin(th)))+(-2)*dq1*(-(( ...
  c1*ml1+l1*ml2)*sin(q1)+c2*ml2*sin(q1+q2))*(cos(psi)*sin(phi)+(-1) ...
  *cos(phi)*sin(psi)*sin(th))+(c1*ml1+l1*ml2)*cos(q1)*(cos(phi)* ...
  cos(psi)+sin(phi)*sin(psi)*sin(th))+c2*ml2*cos(q1+q2)*(cos(phi)* ...
  cos(psi)+sin(phi)*sin(psi)*sin(th)))+dpsi*(2*cos(phi)*(sin(psi)*(( ...
  c1*ml1+l1*ml2)*sin(q1)+c2*ml2*sin(q1+q2))+cos(psi)*(L*(ml1+ml2)+( ...
  c1*ml1+l1*ml2)*cos(q1)+c2*ml2*cos(q1+q2))*sin(th))+(-2)*sin(phi) ...
  *(-(L*(ml1+ml2)+(c1*ml1+l1*ml2)*cos(q1)+c2*ml2*cos(q1+q2))* ...
  sin(psi)+cos(psi)*((c1*ml1+l1*ml2)*sin(q1)+c2*ml2*sin(q1+q2))* ...
  sin(th)))+dphi*(2*sin(phi)*(cos(psi)*((c1*ml1+l1*ml2)*sin(q1)+ ...
  c2*ml2*sin(q1+q2))-(L*(ml1+ml2)+(c1*ml1+l1*ml2)*cos(q1)+c2* ...
  ml2*cos(q1+q2))*sin(psi)*sin(th))+(-2)*cos(phi)*(cos(psi)*(L*( ...
  ml1+ml2)+(c1*ml1+l1*ml2)*cos(q1)+c2*ml2*cos(q1+q2))+sin(psi)*(( ...
  c1*ml1+l1*ml2)*sin(q1)+c2*ml2*sin(q1+q2))*sin(th))));
C17=(1/2)*(cos(psi)*(dth*(c1*ml1+l1*ml2)*cos(q1)*cos(th)*sin(phi)+ ...
  c2*dth*ml2*cos(q1+q2)*cos(th)*sin(phi)+2*c1*dpsi*ml1*sin(phi)* ...
  sin(q1)+2*dpsi*l1*ml2*sin(phi)*sin(q1)+c1*dth*ml1*cos(th)*sin( ...
  phi+q1)+dth*l1*ml2*cos(th)*sin(phi+q1)+2*c2*dpsi*ml2*sin(phi)* ...
  sin(q1+q2)+c2*dth*ml2*cos(th)*sin(phi+q1+q2)+(-2)*c1*dphi*ml1* ...
  sin(phi)*sin(q1)*sin(th)+(-2)*c1*dq1*ml1*sin(phi)*sin(q1)*sin( ...
  th)+(-2)*dphi*l1*ml2*sin(phi)*sin(q1)*sin(th)+(-2)*dq1*l1*ml2* ...
  sin(phi)*sin(q1)*sin(th)+(-2)*c2*dphi*ml2*sin(phi)*sin(q1+q2)* ...
  sin(th)+(-2)*c2*dq1*ml2*sin(phi)*sin(q1+q2)*sin(th)+(-2)*c2* ...
  dq2*ml2*sin(phi)*sin(q1+q2)*sin(th))+2*sin(phi)*sin(psi)*((c1* ...
  ml1+l1*ml2)*cos(q1)*(dphi+dq1-dpsi*sin(th))+c2*ml2*cos(q1+ ...
  q2)*(dphi+dq1+dq2-dpsi*sin(th)))+cos(phi)*(cos(psi)*(c1*dth* ...
  ml1*cos(th)*sin(q1)+dth*l1*ml2*cos(th)*sin(q1)+c2*dth*ml2*cos( ...
  th)*sin(q1+q2)-c2*dphi*ml2*sin(q1)*sin(q2)*sin(th)- ...
  c2*ml2*cos(q1+q2)*(2*dpsi-(dphi+2*(dq1+dq2))*sin(th))+cos( ...
  q1)*((-2)*dpsi*(c1*ml1+l1*ml2)+(2*(dphi+dq1)*(c1*ml1+l1*ml2)+ ...
  c2*dphi*ml2*cos(q2))*sin(th)))+sin(psi)*(c2*ml2*(dphi*cos(q1)* ...
  sin(q2)+sin(q1+q2)*(dphi+2*(dq1+dq2)+(-2)*dpsi*sin(th)))+sin(q1)*( ...
  c2*dphi*ml2*cos(q2)+2*(c1*ml1+l1*ml2)*(dphi+dq1-dpsi*sin( ...
  th))))));
C18=(1/2)*c2*ml2*(2*cos(q1+q2)*sin(phi)*sin(psi)*(dphi+dq1+dq2- ...
  dpsi*sin(th))+cos(psi)*(dth*cos(q1+q2)*cos(th)*sin(phi)+dth*cos( ...
  th)*sin(phi+q1+q2)+2*sin(phi)*sin(q1+q2)*(dpsi-(dphi+dq1+dq2) ...
  *sin(th)))+cos(phi)*(2*sin(psi)*sin(q1+q2)*(dphi+dq1+dq2- ...
  dpsi*sin(th))+cos(psi)*(dth*cos(th)*sin(q1+q2)+2*cos(q1+q2)*((-1) ...
  *dpsi+(dphi+dq1+dq2)*sin(th)))));
end

function [C24, C25, C26, C27, C28] = get_C2()
C24=-dq1*cos(psi)*((c1*ml1+l1*ml2)*sin(phi+q1)+c2*ml2*sin(phi+ ...
  q1+q2))+dth*cos(th)*sin(psi)*(L*(ml1+ml2)*sin(phi)+(c1*ml1+l1* ...
  ml2)*sin(phi+q1)+c2*ml2*sin(phi+q1+q2))+(-1/4)*c2*dq2*ml2*(cos( ...
  phi-psi+q1+q2-th)-cos(phi+psi+q1+q2-th)- ...
  cos(phi-psi+q1+q2+th)+cos(phi+psi+q1+q2+th)+2*sin(phi-psi+ ...
  q1+q2)+2*sin(phi+psi+q1+q2))+dq1*((c1*ml1+l1*ml2)*cos(phi+q1)+c2* ...
  ml2*cos(phi+q1+q2))*sin(psi)*sin(th)+dphi*(-cos(psi)*(L*(ml1+ ...
  ml2)*sin(phi)+(c1*ml1+l1*ml2)*sin(phi+q1)+c2*ml2*sin(phi+q1+q2))+( ...
  L*(ml1+ml2)*cos(phi)+(c1*ml1+l1*ml2)*cos(phi+q1)+c2*ml2*cos(phi+ ...
  q1+q2))*sin(psi)*sin(th))+dpsi*(sin(phi)*(sin(psi)*((c1*ml1+l1* ...
  ml2)*sin(q1)+c2*ml2*sin(q1+q2))+cos(psi)*(L*(ml1+ml2)+(c1*ml1+l1* ...
  ml2)*cos(q1)+c2*ml2*cos(q1+q2))*sin(th))+cos(phi)*(-(L*(ml1+ ...
  ml2)+(c1*ml1+l1*ml2)*cos(q1)+c2*ml2*cos(q1+q2))*sin(psi)+cos(psi) ...
  *((c1*ml1+l1*ml2)*sin(q1)+c2*ml2*sin(q1+q2))*sin(th)));
C25=-dpsi*cos(psi)*(L*(ml1+ml2)*cos(phi)+(c1*ml1+l1*ml2)*cos( ...
  phi+q1)+c2*ml2*cos(phi+q1+q2))*cos(th)+c2*dq2*ml2*cos(th)*sin( ...
  psi)*sin(phi+q1+q2)+dq1*cos(th)*sin(psi)*((c1*ml1+l1*ml2)*sin( ...
  phi+q1)+c2*ml2*sin(phi+q1+q2))+dphi*cos(th)*sin(psi)*(L*(ml1+ml2) ...
  *sin(phi)+(c1*ml1+l1*ml2)*sin(phi+q1)+c2*ml2*sin(phi+q1+q2))+dth* ...
  (L*(ml1+ml2)*cos(phi)+(c1*ml1+l1*ml2)*cos(phi+q1)+c2*ml2*cos(phi+ ...
  q1+q2))*sin(psi)*sin(th);
C26=(1/2)*((-2)*cos(psi)*(dth*(c1*ml1+l1*ml2)*cos(phi+q1)*cos(th)+ ...
  c2*dth*ml2*cos(phi+q1+q2)*cos(th)+sin(phi)*(L*(ml1+ml2)*(dpsi+( ...
  -1)*dphi*sin(th))+(c1*ml1+l1*ml2)*cos(q1)*(dpsi-(dphi+dq1)* ...
  sin(th))+c2*ml2*cos(q1+q2)*(dpsi-(dphi+dq1+dq2)*sin(th))))+( ...
  -1)*cos(phi)*(2*cos(psi)*(dth*L*(ml1+ml2)*cos(th)+(c1*ml1+l1* ...
  ml2)*sin(q1)*(dpsi-(dphi+dq1)*sin(th))+c2*ml2*sin(q1+q2)*( ...
  dpsi-(dphi+dq1+dq2)*sin(th)))+sin(psi)*(2*L*(ml1+ml2)*(dphi+( ...
  -1)*dpsi*sin(th))+(-1/2)*c2*ml2*cos(q1+q2)*((-3)*dphi+(-4)*dq1+( ...
  -4)*dq2+dphi*cos(2*th)+4*dpsi*sin(th))+cos(q1)*(2*c1*(dphi+dq1) ...
  *ml1+(dphi+2*dq1)*l1*ml2+(-2)*dpsi*(c1*ml1+l1*ml2)*sin(th)+ ...
  dphi*l1*ml2*sin(th)^2)))+sin(psi)*(-dphi*l1*ml2*cos(phi+q1) ...
  *cos(th)^2-c2*dphi*ml2*cos(phi+q1+q2)*cos(th)^2+sin(phi)*( ...
  c2*ml2*sin(q1+q2)*(dphi+2*(dq1+dq2)+(-2)*dpsi*sin(th)+dphi*sin( ...
  th)^2)+sin(q1)*(2*c1*(dphi+dq1)*ml1+(dphi+2*dq1)*l1*ml2+(-2)* ...
  dpsi*(c1*ml1+l1*ml2)*sin(th)+dphi*l1*ml2*sin(th)^2))));
C27=-dphi*cos(psi)*((c1*ml1+l1*ml2)*sin(phi+q1)+c2*ml2*sin(phi+ ...
  q1+q2))+dth*cos(th)*sin(psi)*((c1*ml1+l1*ml2)*sin(phi+q1)+c2* ...
  ml2*sin(phi+q1+q2))+dphi*((c1*ml1+l1*ml2)*cos(phi+q1)+c2*ml2*cos( ...
  phi+q1+q2))*sin(psi)*sin(th)-c2*dq2*ml2*(cos(psi)*sin(phi+ ...
  q1+q2)-cos(phi+q1+q2)*sin(psi)*sin(th))+dq1*(-cos(psi)*(( ...
  c1*ml1+l1*ml2)*sin(phi+q1)+c2*ml2*sin(phi+q1+q2))+((c1*ml1+l1* ...
  ml2)*cos(phi+q1)+c2*ml2*cos(phi+q1+q2))*sin(psi)*sin(th))+dpsi*( ...
  sin(phi)*(sin(psi)*((c1*ml1+l1*ml2)*sin(q1)+c2*ml2*sin(q1+q2))+ ...
  cos(psi)*((c1*ml1+l1*ml2)*cos(q1)+c2*ml2*cos(q1+q2))*sin(th))+ ...
  cos(phi)*(-((c1*ml1+l1*ml2)*cos(q1)+c2*ml2*cos(q1+q2))*sin( ...
  psi)+cos(psi)*((c1*ml1+l1*ml2)*sin(q1)+c2*ml2*sin(q1+q2))*sin(th) ...
  ));
C28=(-1/2)*c2*ml2*(2*cos(psi)*sin(phi+q1+q2)*(dphi+dq1+dq2- ...
  dpsi*sin(th))+sin(psi)*(2*dpsi*cos(phi+q1+q2)+(dphi+dq1+dq2- ...
  dth)*sin(phi+q1+q2-th)-(dphi+dq1+dq2+dth)*sin(phi+q1+q2+ ...
  th)));
end

function [C34, C35, C36, C37, C38] = get_C3()
C34=c2*dq2*ml2*cos(phi+q1+q2)*cos(th)+dq1*((c1*ml1+l1*ml2)*cos(phi+ ...
  q1)+c2*ml2*cos(phi+q1+q2))*cos(th)+dphi*(L*(ml1+ml2)*cos(phi)+( ...
  c1*ml1+l1*ml2)*cos(phi+q1)+c2*ml2*cos(phi+q1+q2))*cos(th)- ...
  dth*(L*(ml1+ml2)*sin(phi)+(c1*ml1+l1*ml2)*sin(phi+q1)+c2*ml2* ...
  sin(phi+q1+q2))*sin(th);
C35=dth*(L*(ml1+ml2)*cos(phi)+(c1*ml1+l1*ml2)*cos(phi+q1)+c2*ml2* ...
  cos(phi+q1+q2))*cos(th)-c2*dq2*ml2*sin(phi+q1+q2)*sin(th)+( ...
  -1)*dq1*((c1*ml1+l1*ml2)*sin(phi+q1)+c2*ml2*sin(phi+q1+q2))*sin( ...
  th)-dphi*(L*(ml1+ml2)*sin(phi)+(c1*ml1+l1*ml2)*sin(phi+q1)+ ...
  c2*ml2*sin(phi+q1+q2))*sin(th);
C36=0;
C37=(dphi+dq1)*(c1*ml1+l1*ml2)*cos(phi+q1)*cos(th)+c2*(dphi+dq1+dq2)* ...
  ml2*cos(phi+q1+q2)*cos(th)-dth*((c1*ml1+l1*ml2)*sin(phi+q1)+ ...
  c2*ml2*sin(phi+q1+q2))*sin(th);
C38=c2*ml2*((dphi+dq1+dq2)*cos(phi+q1+q2)*cos(th)-dth*sin(phi+q1+ ...
  q2)*sin(th));
end

function [C44, C45, C46, C47, C48] = get_C4()
C44=-dq1*L*(c1*ml1+l1*ml2)*sin(q1)-c2*ml2*(dq2*l1*sin( ...
  q2)+(dq1+dq2)*L*sin(q1+q2));
C45=(1/2)*(-dpsi*(H1zz+H2zz+Hbx+c1^2*ml1+L^2*ml1+c2^2*ml2+ ...
  L^2*ml2+l1^2*ml2+(Hby-Hbz+L^2*(ml1+ml2))*cos(2*phi)+2* ...
  c1*L*ml1*cos(q1)+2*L*l1*ml2*cos(q1)-H1xx*cos(2*(phi+q1))+ ...
  H1yy*cos(2*(phi+q1))+c1^2*ml1*cos(2*(phi+q1))+l1^2*ml2*cos(2*( ...
  phi+q1))+2*c1*L*ml1*cos(2*phi+q1)+2*L*l1*ml2*cos(2*phi+q1)+2* ...
  c2*l1*ml2*cos(q2)+2*c2*L*ml2*cos(q1+q2)-H2xx*cos(2*(phi+ ...
  q1+q2))+H2yy*cos(2*(phi+q1+q2))+c2^2*ml2*cos(2*(phi+q1+q2))+2* ...
  c2*L*ml2*cos(2*phi+q1+q2)+2*c2*l1*ml2*cos(2*phi+2*q1+q2))* ...
  cos(th)+dth*((Hby-Hbz+L^2*(ml1+ml2))*sin(2*phi)+(-H1xx+ ...
  H1yy+c1^2*ml1+l1^2*ml2)*sin(2*(phi+q1))+2*c1*L*ml1*sin(2*phi+ ...
  q1)+2*L*l1*ml2*sin(2*phi+q1)-H2xx*sin(2*(phi+q1+q2))+H2yy* ...
  sin(2*(phi+q1+q2))+c2^2*ml2*sin(2*(phi+q1+q2))+2*c2*L*ml2*sin( ...
  2*phi+q1+q2)+2*c2*l1*ml2*sin(2*(phi+q1)+q2)));
C46=(1/2)*dth*(-(H1zz+H2zz+Hbx+c1^2*ml1+L^2*ml1+c2^2*ml2+L^2* ...
  ml2+l1^2*ml2+2*L*(c1*ml1+l1*ml2)*cos(q1)+2*c2*l1*ml2*cos(q2)+ ...
  2*c2*L*ml2*cos(q1+q2))*cos(th)-((Hby-Hbz+L^2*(ml1+ ...
  ml2))*cos(2*phi)+(-H1xx+H1yy+c1^2*ml1+l1^2*ml2)*cos(2*(phi+ ...
  q1))+2*c1*L*ml1*cos(2*phi+q1)+2*L*l1*ml2*cos(2*phi+q1)- ...
  H2xx*cos(2*(phi+q1+q2))+H2yy*cos(2*(phi+q1+q2))+c2^2*ml2*cos(2*( ...
  phi+q1+q2))+2*c2*L*ml2*cos(2*phi+q1+q2)+2*c2*l1*ml2*cos(2*( ...
  phi+q1)+q2))*cos(th))+(-1/2)*dpsi*cos(th)^2*((Hby-Hbz+L^2*( ...
  ml1+ml2))*sin(2*phi)+(-H1xx+H1yy+c1^2*ml1+l1^2*ml2)*sin(2*( ...
  phi+q1))+2*c1*L*ml1*sin(2*phi+q1)+2*L*l1*ml2*sin(2*phi+q1)+( ...
  -1)*H2xx*sin(2*(phi+q1+q2))+H2yy*sin(2*(phi+q1+q2))+c2^2*ml2* ...
  sin(2*(phi+q1+q2))+2*c2*L*ml2*sin(2*phi+q1+q2)+2*c2*l1*ml2* ...
  sin(2*(phi+q1)+q2))+c2*dq2*ml2*(l1*sin(q2)+L*sin(q1+q2))*sin(th)+ ...
  dq1*L*((c1*ml1+l1*ml2)*sin(q1)+c2*ml2*sin(q1+q2))*sin(th);
C47=-c2*dq2*ml2*(l1*sin(q2)+L*sin(q1+q2))-L*((c1*ml1+l1* ...
  ml2)*sin(q1)+c2*ml2*sin(q1+q2))*(dphi+dq1-dpsi*sin(th));
C48=-c2*ml2*(l1*sin(q2)+L*sin(q1+q2))*(dphi+dq1+dq2-dpsi* ...
  sin(th));
end

function [C54, C55, C56, C57, C58] = get_C5()
C54=(1/2)*(dpsi*(H1zz+H2zz+Hbx+c1^2*ml1+L^2*ml1+c2^2*ml2+L^2*ml2+ ...
  l1^2*ml2+(Hby-Hbz+L^2*(ml1+ml2))*cos(2*phi)+2*c1*L*ml1* ...
  cos(q1)+2*L*l1*ml2*cos(q1)-H1xx*cos(2*(phi+q1))+H1yy*cos( ...
  2*(phi+q1))+c1^2*ml1*cos(2*(phi+q1))+l1^2*ml2*cos(2*(phi+q1))+ ...
  2*c1*L*ml1*cos(2*phi+q1)+2*L*l1*ml2*cos(2*phi+q1)+2*c2*l1* ...
  ml2*cos(q2)+2*c2*L*ml2*cos(q1+q2)-H2xx*cos(2*(phi+q1+q2))+ ...
  H2yy*cos(2*(phi+q1+q2))+c2^2*ml2*cos(2*(phi+q1+q2))+2*c2*L* ...
  ml2*cos(2*phi+q1+q2)+2*c2*l1*ml2*cos(2*phi+2*q1+q2))*cos(th)+( ...
  -1)*dth*((Hby-Hbz+L^2*(ml1+ml2))*sin(2*phi)+(-H1xx+ ...
  H1yy+c1^2*ml1+l1^2*ml2)*sin(2*(phi+q1))+2*c1*L*ml1*sin(2*phi+ ...
  q1)+2*L*l1*ml2*sin(2*phi+q1)-H2xx*sin(2*(phi+q1+q2))+H2yy* ...
  sin(2*(phi+q1+q2))+c2^2*ml2*sin(2*(phi+q1+q2))+2*c2*L*ml2*sin( ...
  2*phi+q1+q2)+2*c2*l1*ml2*sin(2*(phi+q1)+q2)));
C55=(1/2)*((-2)*dq2*(c2*L*ml2*cos(phi)+c2*l1*ml2*cos(phi+q1)+((-1) ...
  *H2xx+H2yy+c2^2*ml2)*cos(phi+q1+q2))*sin(phi+q1+q2)-dq1*(L* ...
  (c1*ml1+l1*ml2)*sin(q1)+(-H1xx+H1yy+c1^2*ml1+l1^2*ml2)*sin( ...
  2*(phi+q1))+c1*L*ml1*sin(2*phi+q1)+L*l1*ml2*sin(2*phi+q1)+c2* ...
  L*ml2*sin(q1+q2)-H2xx*sin(2*(phi+q1+q2))+H2yy*sin(2*(phi+q1+ ...
  q2))+c2^2*ml2*sin(2*(phi+q1+q2))+c2*L*ml2*sin(2*phi+q1+q2)+2* ...
  c2*l1*ml2*sin(2*(phi+q1)+q2))-dphi*((Hby-Hbz+L^2*( ...
  ml1+ml2))*sin(2*phi)+(-H1xx+H1yy+c1^2*ml1+l1^2*ml2)*sin(2*( ...
  phi+q1))+2*c1*L*ml1*sin(2*phi+q1)+2*L*l1*ml2*sin(2*phi+q1)+( ...
  -1)*H2xx*sin(2*(phi+q1+q2))+H2yy*sin(2*(phi+q1+q2))+c2^2*ml2* ...
  sin(2*(phi+q1+q2))+2*c2*L*ml2*sin(2*phi+q1+q2)+2*c2*l1*ml2* ...
  sin(2*(phi+q1)+q2)));
C56=(1/2)*(dq2*(H2zz+c2^2*ml2+c2*l1*ml2*cos(q2)+c2*L*ml2*cos(q1+ ...
  q2)-H2xx*cos(2*(phi+q1+q2))+H2yy*cos(2*(phi+q1+q2))+c2^2* ...
  ml2*cos(2*(phi+q1+q2))+c2*L*ml2*cos(2*phi+q1+q2)+c2*l1*ml2*cos( ...
  2*(phi+q1)+q2))*cos(th)+dq1*(H1zz+H2zz+c1^2*ml1+c2^2*ml2+l1^2* ...
  ml2+L*(c1*ml1+l1*ml2)*cos(q1)+(-H1xx+H1yy+c1^2*ml1+l1^2* ...
  ml2)*cos(2*(phi+q1))+c1*L*ml1*cos(2*phi+q1)+L*l1*ml2*cos(2* ...
  phi+q1)+2*c2*l1*ml2*cos(q2)+c2*L*ml2*cos(q1+q2)-H2xx*cos( ...
  2*(phi+q1+q2))+H2yy*cos(2*(phi+q1+q2))+c2^2*ml2*cos(2*(phi+q1+q2) ...
  )+c2*L*ml2*cos(2*phi+q1+q2)+2*c2*l1*ml2*cos(2*(phi+q1)+q2))* ...
  cos(th)+dphi*(H1zz+H2zz+Hbx+c1^2*ml1+L^2*ml1+c2^2*ml2+L^2*ml2+ ...
  l1^2*ml2+(Hby-Hbz+L^2*(ml1+ml2))*cos(2*phi)+2*L*(c1*ml1+ ...
  l1*ml2)*cos(q1)+(-H1xx+H1yy+c1^2*ml1+l1^2*ml2)*cos(2*(phi+ ...
  q1))+2*c1*L*ml1*cos(2*phi+q1)+2*L*l1*ml2*cos(2*phi+q1)+2*c2* ...
  l1*ml2*cos(q2)+2*c2*L*ml2*cos(q1+q2)-H2xx*cos(2*(phi+q1+ ...
  q2))+H2yy*cos(2*(phi+q1+q2))+c2^2*ml2*cos(2*(phi+q1+q2))+2*c2* ...
  L*ml2*cos(2*phi+q1+q2)+2*c2*l1*ml2*cos(2*(phi+q1)+q2))*cos(th)+ ...
  (1/2)*dpsi*(H1xx+H1yy+(-2)*H1zz+H2xx+H2yy+(-2)*H2zz+(-2)*Hbx+Hby+ ...
  Hbz-c1^2*ml1-L^2*ml1-c2^2*ml2-L^2*ml2+( ...
  -1)*l1^2*ml2-(Hby-Hbz+L^2*(ml1+ml2))*cos(2*phi)+(-2) ...
  *L*(c1*ml1+l1*ml2)*cos(q1)+H1xx*cos(2*(phi+q1))-H1yy*cos( ...
  2*(phi+q1))-c1^2*ml1*cos(2*(phi+q1))-l1^2*ml2*cos( ...
  2*(phi+q1))+(-2)*c1*L*ml1*cos(2*phi+q1)+(-2)*L*l1*ml2*cos(2* ...
  phi+q1)+(-2)*c2*l1*ml2*cos(q2)+(-2)*c2*L*ml2*cos(q1+q2)+H2xx* ...
  cos(2*(phi+q1+q2))-H2yy*cos(2*(phi+q1+q2))-c2^2*ml2* ...
  cos(2*(phi+q1+q2))+(-2)*c2*L*ml2*cos(2*phi+q1+q2)+(-2)*c2*l1* ...
  ml2*cos(2*(phi+q1)+q2))*sin(2*th));
C57=(1/2)*(dpsi*(H1zz+H2zz+c1^2*ml1+c2^2*ml2+l1^2*ml2+L*(c1*ml1+ ...
  l1*ml2)*cos(q1)+(-H1xx+H1yy+c1^2*ml1+l1^2*ml2)*cos(2*(phi+ ...
  q1))+c1*L*ml1*cos(2*phi+q1)+L*l1*ml2*cos(2*phi+q1)+2*c2*l1* ...
  ml2*cos(q2)+c2*L*ml2*cos(q1+q2)-H2xx*cos(2*(phi+q1+q2))+ ...
  H2yy*cos(2*(phi+q1+q2))+c2^2*ml2*cos(2*(phi+q1+q2))+c2*L*ml2* ...
  cos(2*phi+q1+q2)+2*c2*l1*ml2*cos(2*phi+2*q1+q2))*cos(th)- ...
  dth*(L*(c1*ml1+l1*ml2)*sin(q1)+(-H1xx+H1yy+c1^2*ml1+l1^2* ...
  ml2)*sin(2*(phi+q1))+c1*L*ml1*sin(2*phi+q1)+L*l1*ml2*sin(2* ...
  phi+q1)+c2*L*ml2*sin(q1+q2)-H2xx*sin(2*(phi+q1+q2))+H2yy* ...
  sin(2*(phi+q1+q2))+c2^2*ml2*sin(2*(phi+q1+q2))+c2*L*ml2*sin(2* ...
  phi+q1+q2)+2*c2*l1*ml2*sin(2*(phi+q1)+q2)));
C58=(1/2)*dpsi*(H2zz+c2^2*ml2+c2*l1*ml2*cos(q2)+c2*L*ml2*cos(q1+ ...
  q2)-H2xx*cos(2*(phi+q1+q2))+H2yy*cos(2*(phi+q1+q2))+c2^2* ...
  ml2*cos(2*(phi+q1+q2))+c2*L*ml2*cos(2*phi+q1+q2)+c2*l1*ml2*cos( ...
  2*(phi+q1)+q2))*cos(th)-dth*(c2*L*ml2*cos(phi)+c2*l1*ml2* ...
  cos(phi+q1)+(-H2xx+H2yy+c2^2*ml2)*cos(phi+q1+q2))*sin(phi+q1+ ...
  q2);
end

function [C64, C65, C66, C67, C68] = get_C6()
C64=(1/4)*dth*(2*(Hby-Hbz+L^2*(ml1+ml2))*cos(2*phi)+2*(- ...
  H1xx+H1yy+c1^2*ml1+l1^2*ml2)*cos(2*(phi+q1))+4*c1*L*ml1*cos( ...
  2*phi+q1)+4*L*l1*ml2*cos(2*phi+q1)+(-2)*(H1zz+H2zz+Hbx+c1^2* ...
  ml1+L^2*ml1+c2^2*ml2+L^2*ml2+l1^2*ml2+2*L*(c1*ml1+l1*ml2)* ...
  cos(q1)+2*c2*l1*ml2*cos(q2)+2*c2*L*ml2*cos(q1+q2))+(-2)*H2xx* ...
  cos(2*(phi+q1+q2))+2*H2yy*cos(2*(phi+q1+q2))+2*c2^2*ml2*cos(2*( ...
  phi+q1+q2))+4*c2*L*ml2*cos(2*phi+q1+q2)+4*c2*l1*ml2*cos(2*( ...
  phi+q1)+q2))*cos(th)+(1/2)*dpsi*cos(th)^2*((Hby-Hbz+L^2*( ...
  ml1+ml2))*sin(2*phi)+(-H1xx+H1yy+c1^2*ml1+l1^2*ml2)*sin(2*( ...
  phi+q1))+2*c1*L*ml1*sin(2*phi+q1)+2*L*l1*ml2*sin(2*phi+q1)+( ...
  -1)*H2xx*sin(2*(phi+q1+q2))+H2yy*sin(2*(phi+q1+q2))+c2^2*ml2* ...
  sin(2*(phi+q1+q2))+2*c2*L*ml2*sin(2*phi+q1+q2)+2*c2*l1*ml2* ...
  sin(2*(phi+q1)+q2))+c2*dq2*ml2*(l1*sin(q2)+L*sin(q1+q2))*sin(th)+ ...
  dq1*L*((c1*ml1+l1*ml2)*sin(q1)+c2*ml2*sin(q1+q2))*sin(th);
C65=(1/4)*((-2)*dq2*(H2zz+c2^2*ml2+c2*l1*ml2*cos(q2)+c2*L*ml2* ...
  cos(q1+q2)+H2xx*cos(2*(phi+q1+q2))-H2yy*cos(2*(phi+q1+q2))+( ...
  -1)*c2^2*ml2*cos(2*(phi+q1+q2))-c2*L*ml2*cos(2*phi+q1+q2) ...
  -c2*l1*ml2*cos(2*(phi+q1)+q2))*cos(th)+dq1*(2*(-H1xx+ ...
  H1yy+c1^2*ml1+l1^2*ml2)*cos(2*(phi+q1))+2*c1*L*ml1*cos(2*phi+ ...
  q1)+2*L*l1*ml2*cos(2*phi+q1)+(-2)*(H1zz+H2zz+c1^2*ml1+c2^2* ...
  ml2+l1^2*ml2+L*(c1*ml1+l1*ml2)*cos(q1)+2*c2*l1*ml2*cos(q2)+ ...
  c2*L*ml2*cos(q1+q2))+(-2)*H2xx*cos(2*(phi+q1+q2))+2*H2yy*cos(2* ...
  (phi+q1+q2))+2*c2^2*ml2*cos(2*(phi+q1+q2))+2*c2*L*ml2*cos(2* ...
  phi+q1+q2)+4*c2*l1*ml2*cos(2*(phi+q1)+q2))*cos(th)+dphi*(2*(Hby+ ...
  -Hbz+L^2*(ml1+ml2))*cos(2*phi)+2*(-H1xx+H1yy+c1^2*ml1+ ...
  l1^2*ml2)*cos(2*(phi+q1))+4*c1*L*ml1*cos(2*phi+q1)+4*L*l1* ...
  ml2*cos(2*phi+q1)+(-2)*(H1zz+H2zz+Hbx+c1^2*ml1+L^2*ml1+c2^2* ...
  ml2+L^2*ml2+l1^2*ml2+2*L*(c1*ml1+l1*ml2)*cos(q1)+2*c2*l1* ...
  ml2*cos(q2)+2*c2*L*ml2*cos(q1+q2))+(-2)*H2xx*cos(2*(phi+q1+q2))+ ...
  2*H2yy*cos(2*(phi+q1+q2))+2*c2^2*ml2*cos(2*(phi+q1+q2))+4*c2* ...
  L*ml2*cos(2*phi+q1+q2)+4*c2*l1*ml2*cos(2*(phi+q1)+q2))*cos(th)+ ...
  (-2)*dth*((Hby-Hbz+L^2*(ml1+ml2))*sin(2*phi)+(-H1xx+ ...
  H1yy+c1^2*ml1+l1^2*ml2)*sin(2*(phi+q1))+2*c1*L*ml1*sin(2*phi+ ...
  q1)+2*L*l1*ml2*sin(2*phi+q1)-H2xx*sin(2*(phi+q1+q2))+H2yy* ...
  sin(2*(phi+q1+q2))+c2^2*ml2*sin(2*(phi+q1+q2))+2*c2*L*ml2*sin( ...
  2*phi+q1+q2)+2*c2*l1*ml2*sin(2*(phi+q1)+q2))*sin(th)-dpsi* ...
  (H1xx+H1yy+(-2)*H1zz+H2xx+H2yy+(-2)*H2zz+(-2)*Hbx+Hby+Hbz- ...
  c1^2*ml1-L^2*ml1-c2^2*ml2-L^2*ml2- ...
  l1^2*ml2-(Hby-Hbz+L^2*(ml1+ml2))*cos(2*phi)+(-2)*L*( ...
  c1*ml1+l1*ml2)*cos(q1)+H1xx*cos(2*(phi+q1))-H1yy*cos(2*( ...
  phi+q1))-c1^2*ml1*cos(2*(phi+q1))-l1^2*ml2*cos(2*( ...
  phi+q1))+(-2)*c1*L*ml1*cos(2*phi+q1)+(-2)*L*l1*ml2*cos(2*phi+ ...
  q1)+(-2)*c2*l1*ml2*cos(q2)+(-2)*c2*L*ml2*cos(q1+q2)+H2xx*cos( ...
  2*(phi+q1+q2))-H2yy*cos(2*(phi+q1+q2))-c2^2*ml2*cos( ...
  2*(phi+q1+q2))+(-2)*c2*L*ml2*cos(2*phi+q1+q2)+(-2)*c2*l1*ml2* ...
  cos(2*(phi+q1)+q2))*sin(2*th));
C66=(1/2)*(dphi*cos(th)^2*((Hby-Hbz+L^2*(ml1+ml2))*sin(2*phi)+ ...
  (-H1xx+H1yy+c1^2*ml1+l1^2*ml2)*sin(2*(phi+q1))+2*c1*L* ...
  ml1*sin(2*phi+q1)+2*L*l1*ml2*sin(2*phi+q1)-H2xx*sin(2*( ...
  phi+q1+q2))+H2yy*sin(2*(phi+q1+q2))+c2^2*ml2*sin(2*(phi+q1+q2))+ ...
  2*c2*L*ml2*sin(2*phi+q1+q2)+2*c2*l1*ml2*sin(2*(phi+q1)+q2))+ ...
  dq2*((-2)*(H2xx-H2yy)*cos(phi)*cos(2*(q1+q2))*cos(th)^2* ...
  sin(phi)-(H2xx-H2yy)*cos(phi)^2*cos(th)^2*sin(2*(q1+ ...
  q2))+(H2xx-H2yy)*cos(th)^2*sin(phi)^2*sin(2*(q1+q2))+2* ...
  ml2*(c2*sin(q1+q2)*(sin(phi)*sin(psi)+cos(phi)*cos(psi)*sin(th))+ ...
  c2*cos(q1+q2)*(-cos(phi)*sin(psi)+cos(psi)*sin(phi)*sin(th))) ...
  *(-(L+l1*cos(q1)+c2*cos(q1+q2))*(sin(phi)*sin(psi)+cos(phi)* ...
  cos(psi)*sin(th))+(l1*sin(q1)+c2*sin(q1+q2))*(-cos(phi)*sin( ...
  psi)+cos(psi)*sin(phi)*sin(th)))+2*ml2*(cos(psi)*(L*sin(phi)+l1* ...
  sin(phi+q1)+c2*sin(phi+q1+q2))-(L*cos(phi)+l1*cos(phi+q1)+c2* ...
  cos(phi+q1+q2))*sin(psi)*sin(th))*(c2*sin(q1+q2)*(-cos(psi)* ...
  sin(phi)+cos(phi)*sin(psi)*sin(th))+c2*cos(q1+q2)*(cos(phi)*cos( ...
  psi)+sin(phi)*sin(psi)*sin(th))))+dq1*((-2)*(H2xx-H2yy)*cos( ...
  phi)*cos(2*(q1+q2))*cos(th)^2*sin(phi)-(H1xx-H1yy)* ...
  cos(q1)^2*cos(th)^2*sin(2*phi)+(H1xx-H1yy)*cos(th)^2*sin( ...
  2*phi)*sin(q1)^2-(H1xx-H1yy)*cos(phi)^2*cos(th)^2* ...
  sin(2*q1)+(H1xx-H1yy)*cos(th)^2*sin(phi)^2*sin(2*q1)- ...
  (H2xx-H2yy)*cos(phi)^2*cos(th)^2*sin(2*(q1+q2))+(H2xx- ...
  H2yy)*cos(th)^2*sin(phi)^2*sin(2*(q1+q2))+2*ml2*((l1*sin(q1)+ ...
  c2*sin(q1+q2))*(sin(phi)*sin(psi)+cos(phi)*cos(psi)*sin(th))+(l1* ...
  cos(q1)+c2*cos(q1+q2))*(-cos(phi)*sin(psi)+cos(psi)*sin(phi)* ...
  sin(th)))*(-(L+l1*cos(q1)+c2*cos(q1+q2))*(sin(phi)*sin(psi)+ ...
  cos(phi)*cos(psi)*sin(th))+(l1*sin(q1)+c2*sin(q1+q2))*(-cos( ...
  phi)*sin(psi)+cos(psi)*sin(phi)*sin(th)))+2*ml2*(cos(psi)*(L*sin( ...
  phi)+l1*sin(phi+q1)+c2*sin(phi+q1+q2))-(L*cos(phi)+l1*cos(phi+ ...
  q1)+c2*cos(phi+q1+q2))*sin(psi)*sin(th))*(-(l1*sin(q1)+c2* ...
  sin(q1+q2))*(cos(psi)*sin(phi)-cos(phi)*sin(psi)*sin(th))+( ...
  l1*cos(q1)+c2*cos(q1+q2))*(cos(phi)*cos(psi)+sin(phi)*sin(psi)* ...
  sin(th)))+2*c1*ml1*(-(L+c1*cos(q1))*(sin(phi)*sin(psi)+cos( ...
  phi)*cos(psi)*sin(th))+c1*sin(q1)*(-cos(phi)*sin(psi)+cos(psi) ...
  *sin(phi)*sin(th)))*(sin(phi)*(sin(psi)*sin(q1)+cos(psi)*cos(q1)* ...
  sin(th))+cos(phi)*(-cos(q1)*sin(psi)+cos(psi)*sin(q1)*sin(th))) ...
  +2*ml1*(cos(psi)*(L*sin(phi)+c1*sin(phi+q1))-(L*cos(phi)+ ...
  c1*cos(phi+q1))*sin(psi)*sin(th))*(c1*sin(phi)*(-cos(psi)* ...
  sin(q1)+cos(q1)*sin(psi)*sin(th))+c1*cos(phi)*(cos(psi)*cos(q1)+ ...
  sin(psi)*sin(q1)*sin(th))))+(-1/2)*dth*(H1xx+H1yy+(-2)*H1zz+H2xx+ ...
  H2yy+(-2)*H2zz+(-2)*Hbx+Hby+Hbz-c1^2*ml1-L^2*ml1+(-1) ...
  *c2^2*ml2-L^2*ml2-l1^2*ml2-(Hby-Hbz+ ...
  L^2*(ml1+ml2))*cos(2*phi)+(-2)*L*(c1*ml1+l1*ml2)*cos(q1)+H1xx* ...
  cos(2*(phi+q1))-H1yy*cos(2*(phi+q1))-c1^2*ml1*cos(2*( ...
  phi+q1))-l1^2*ml2*cos(2*(phi+q1))+(-2)*c1*L*ml1*cos(2* ...
  phi+q1)+(-2)*L*l1*ml2*cos(2*phi+q1)+(-2)*c2*l1*ml2*cos(q2)+(-2) ...
  *c2*L*ml2*cos(q1+q2)+H2xx*cos(2*(phi+q1+q2))-H2yy*cos(2*( ...
  phi+q1+q2))-c2^2*ml2*cos(2*(phi+q1+q2))+(-2)*c2*L*ml2*cos( ...
  2*phi+q1+q2)+(-2)*c2*l1*ml2*cos(2*(phi+q1)+q2))*sin(2*th));
C67=(1/4)*dth*(2*(-H1xx+H1yy+c1^2*ml1+l1^2*ml2)*cos(2*(phi+q1) ...
  )+2*c1*L*ml1*cos(2*phi+q1)+2*L*l1*ml2*cos(2*phi+q1)+(-2)*( ...
  H1zz+H2zz+c1^2*ml1+c2^2*ml2+l1^2*ml2+L*(c1*ml1+l1*ml2)*cos(q1) ...
  +2*c2*l1*ml2*cos(q2)+c2*L*ml2*cos(q1+q2))+(-2)*H2xx*cos(2*( ...
  phi+q1+q2))+2*H2yy*cos(2*(phi+q1+q2))+2*c2^2*ml2*cos(2*(phi+q1+ ...
  q2))+2*c2*L*ml2*cos(2*phi+q1+q2)+4*c2*l1*ml2*cos(2*(phi+q1)+ ...
  q2))*cos(th)+c2*dq2*ml2*(l1*sin(q2)+L*sin(q1+q2))*sin(th)+dphi* ...
  L*((c1*ml1+l1*ml2)*sin(q1)+c2*ml2*sin(q1+q2))*sin(th)+dq1*L*(( ...
  c1*ml1+l1*ml2)*sin(q1)+c2*ml2*sin(q1+q2))*sin(th)+(1/2)*dpsi*(( ...
  -2)*(H2xx-H2yy)*cos(phi)*cos(2*(q1+q2))*cos(th)^2*sin(phi)+ ...
  -(H1xx-H1yy)*cos(q1)^2*cos(th)^2*sin(2*phi)+(H1xx+(-1) ...
  *H1yy)*cos(th)^2*sin(2*phi)*sin(q1)^2-(H1xx-H1yy)* ...
  cos(phi)^2*cos(th)^2*sin(2*q1)+(H1xx-H1yy)*cos(th)^2*sin( ...
  phi)^2*sin(2*q1)-(H2xx-H2yy)*cos(phi)^2*cos(th)^2* ...
  sin(2*(q1+q2))+(H2xx-H2yy)*cos(th)^2*sin(phi)^2*sin(2*(q1+ ...
  q2))+2*ml2*((l1*sin(q1)+c2*sin(q1+q2))*(sin(phi)*sin(psi)+cos(phi) ...
  *cos(psi)*sin(th))+(l1*cos(q1)+c2*cos(q1+q2))*(-cos(phi)*sin( ...
  psi)+cos(psi)*sin(phi)*sin(th)))*(-(L+l1*cos(q1)+c2*cos(q1+q2) ...
  )*(sin(phi)*sin(psi)+cos(phi)*cos(psi)*sin(th))+(l1*sin(q1)+c2* ...
  sin(q1+q2))*(-cos(phi)*sin(psi)+cos(psi)*sin(phi)*sin(th)))+2* ...
  ml2*(cos(psi)*(L*sin(phi)+l1*sin(phi+q1)+c2*sin(phi+q1+q2))-( ...
  L*cos(phi)+l1*cos(phi+q1)+c2*cos(phi+q1+q2))*sin(psi)*sin(th))*(( ...
  -1)*(l1*sin(q1)+c2*sin(q1+q2))*(cos(psi)*sin(phi)-cos(phi)* ...
  sin(psi)*sin(th))+(l1*cos(q1)+c2*cos(q1+q2))*(cos(phi)*cos(psi)+ ...
  sin(phi)*sin(psi)*sin(th)))+2*c1*ml1*(-(L+c1*cos(q1))*(sin( ...
  phi)*sin(psi)+cos(phi)*cos(psi)*sin(th))+c1*sin(q1)*(-cos(phi) ...
  *sin(psi)+cos(psi)*sin(phi)*sin(th)))*(sin(phi)*(sin(psi)*sin(q1)+ ...
  cos(psi)*cos(q1)*sin(th))+cos(phi)*(-cos(q1)*sin(psi)+cos(psi) ...
  *sin(q1)*sin(th)))+2*ml1*(cos(psi)*(L*sin(phi)+c1*sin(phi+q1))+( ...
  -1)*(L*cos(phi)+c1*cos(phi+q1))*sin(psi)*sin(th))*(c1*sin(phi)*( ...
  -cos(psi)*sin(q1)+cos(q1)*sin(psi)*sin(th))+c1*cos(phi)*(cos( ...
  psi)*cos(q1)+sin(psi)*sin(q1)*sin(th))));
C68=(-1/2)*dth*(H2zz+c2^2*ml2+c2*l1*ml2*cos(q2)+c2*L*ml2*cos(q1+ ...
  q2)+H2xx*cos(2*(phi+q1+q2))-H2yy*cos(2*(phi+q1+q2))- ...
  c2^2*ml2*cos(2*(phi+q1+q2))-c2*L*ml2*cos(2*phi+q1+q2)+(-1) ...
  *c2*l1*ml2*cos(2*(phi+q1)+q2))*cos(th)+c2*dphi*ml2*(l1*sin(q2) ...
  +L*sin(q1+q2))*sin(th)+c2*dq1*ml2*(l1*sin(q2)+L*sin(q1+q2))*sin( ...
  th)+c2*dq2*ml2*(l1*sin(q2)+L*sin(q1+q2))*sin(th)+(1/2)*dpsi*(( ...
  -2)*(H2xx-H2yy)*cos(phi)*cos(2*(q1+q2))*cos(th)^2*sin(phi)+ ...
  -(H2xx-H2yy)*cos(phi)^2*cos(th)^2*sin(2*(q1+q2))+(H2xx+ ...
  -H2yy)*cos(th)^2*sin(phi)^2*sin(2*(q1+q2))+2*ml2*(c2*sin( ...
  q1+q2)*(sin(phi)*sin(psi)+cos(phi)*cos(psi)*sin(th))+c2*cos(q1+q2) ...
  *(-cos(phi)*sin(psi)+cos(psi)*sin(phi)*sin(th)))*(-(L+ ...
  l1*cos(q1)+c2*cos(q1+q2))*(sin(phi)*sin(psi)+cos(phi)*cos(psi)* ...
  sin(th))+(l1*sin(q1)+c2*sin(q1+q2))*(-cos(phi)*sin(psi)+cos( ...
  psi)*sin(phi)*sin(th)))+2*ml2*(cos(psi)*(L*sin(phi)+l1*sin(phi+ ...
  q1)+c2*sin(phi+q1+q2))-(L*cos(phi)+l1*cos(phi+q1)+c2*cos(phi+ ...
  q1+q2))*sin(psi)*sin(th))*(c2*sin(q1+q2)*(-cos(psi)*sin(phi)+ ...
  cos(phi)*sin(psi)*sin(th))+c2*cos(q1+q2)*(cos(phi)*cos(psi)+sin( ...
  phi)*sin(psi)*sin(th))));
end

function [C74, C75, C76, C77, C78] = get_C7()
C74=-c2*dq2*l1*ml2*sin(q2)+L*((c1*ml1+l1*ml2)*sin(q1)+c2*ml2* ...
  sin(q1+q2))*(dphi-dpsi*sin(th));
C75=(1/2)*(-dpsi*(H1zz+H2zz+c1^2*ml1+c2^2*ml2+l1^2*ml2+L*(c1* ...
  ml1+l1*ml2)*cos(q1)+(-H1xx+H1yy+c1^2*ml1+l1^2*ml2)*cos(2*( ...
  phi+q1))+c1*L*ml1*cos(2*phi+q1)+L*l1*ml2*cos(2*phi+q1)+2*c2* ...
  l1*ml2*cos(q2)+c2*L*ml2*cos(q1+q2)-H2xx*cos(2*(phi+q1+q2))+ ...
  H2yy*cos(2*(phi+q1+q2))+c2^2*ml2*cos(2*(phi+q1+q2))+c2*L*ml2* ...
  cos(2*phi+q1+q2)+2*c2*l1*ml2*cos(2*phi+2*q1+q2))*cos(th)+dth*( ...
  L*(c1*ml1+l1*ml2)*sin(q1)+(-H1xx+H1yy+c1^2*ml1+l1^2*ml2)* ...
  sin(2*(phi+q1))+c1*L*ml1*sin(2*phi+q1)+L*l1*ml2*sin(2*phi+q1)+ ...
  c2*L*ml2*sin(q1+q2)-H2xx*sin(2*(phi+q1+q2))+H2yy*sin(2*( ...
  phi+q1+q2))+c2^2*ml2*sin(2*(phi+q1+q2))+c2*L*ml2*sin(2*phi+q1+ ...
  q2)+2*c2*l1*ml2*sin(2*(phi+q1)+q2)));
C76=(1/2)*(dth*(-(H1zz+H2zz+c1^2*ml1+c2^2*ml2+l1^2*ml2+L*(c1* ...
  ml1+l1*ml2)*cos(q1)+2*c2*l1*ml2*cos(q2)+c2*L*ml2*cos(q1+q2))* ...
  cos(th)-((-H1xx+H1yy+c1^2*ml1+l1^2*ml2)*cos(2*(phi+q1)) ...
  +c1*L*ml1*cos(2*phi+q1)+L*l1*ml2*cos(2*phi+q1)+(-H2xx+H2yy+ ...
  c2^2*ml2)*cos(2*(phi+q1+q2))+c2*L*ml2*cos(2*phi+q1+q2)+2*c2* ...
  l1*ml2*cos(2*(phi+q1)+q2))*cos(th))+2*c2*dq2*l1*ml2*sin(q2)* ...
  sin(th)+(-2)*dphi*L*((c1*ml1+l1*ml2)*sin(q1)+c2*ml2*sin(q1+q2)) ...
  *sin(th)+dpsi*((H1xx-H1yy)*cos(q1)^2*cos(th)^2*sin(2*phi)+ ...
  (H2xx-H2yy)*cos(2*(q1+q2))*cos(th)^2*sin(2*phi)-(H1xx+ ...
  -H1yy)*cos(th)^2*sin(2*phi)*sin(q1)^2+(H1xx-H1yy)*cos( ...
  phi)^2*cos(th)^2*sin(2*q1)-(H1xx-H1yy)*cos(th)^2* ...
  sin(phi)^2*sin(2*q1)+(H2xx-H2yy)*cos(phi)^2*cos(th)^2*sin( ...
  2*(q1+q2))+(-H2xx+H2yy)*cos(th)^2*sin(phi)^2*sin(2*(q1+q2))+ ...
  (-2)*ml2*((l1*sin(q1)+c2*sin(q1+q2))*(sin(phi)*sin(psi)+cos(phi)* ...
  cos(psi)*sin(th))+(l1*cos(q1)+c2*cos(q1+q2))*(-cos(phi)*sin( ...
  psi)+cos(psi)*sin(phi)*sin(th)))*(-(L+l1*cos(q1)+c2*cos(q1+q2) ...
  )*(sin(phi)*sin(psi)+cos(phi)*cos(psi)*sin(th))+(l1*sin(q1)+c2* ...
  sin(q1+q2))*(-cos(phi)*sin(psi)+cos(psi)*sin(phi)*sin(th)))+( ...
  -2)*ml2*(cos(psi)*(L*sin(phi)+l1*sin(phi+q1)+c2*sin(phi+q1+q2))+( ...
  -1)*(L*cos(phi)+l1*cos(phi+q1)+c2*cos(phi+q1+q2))*sin(psi)*sin(th) ...
  )*(-(l1*sin(q1)+c2*sin(q1+q2))*(cos(psi)*sin(phi)-cos( ...
  phi)*sin(psi)*sin(th))+(l1*cos(q1)+c2*cos(q1+q2))*(cos(phi)*cos( ...
  psi)+sin(phi)*sin(psi)*sin(th)))+(-2)*c1*ml1*(-(L+c1*cos(q1)) ...
  *(sin(phi)*sin(psi)+cos(phi)*cos(psi)*sin(th))+c1*sin(q1)*(- ...
  cos(phi)*sin(psi)+cos(psi)*sin(phi)*sin(th)))*(sin(phi)*(sin(psi)* ...
  sin(q1)+cos(psi)*cos(q1)*sin(th))+cos(phi)*(-cos(q1)*sin(psi)+ ...
  cos(psi)*sin(q1)*sin(th)))+(-2)*ml1*(cos(psi)*(L*sin(phi)+c1*sin( ...
  phi+q1))-(L*cos(phi)+c1*cos(phi+q1))*sin(psi)*sin(th))*(c1* ...
  sin(phi)*(-cos(psi)*sin(q1)+cos(q1)*sin(psi)*sin(th))+c1*cos( ...
  phi)*(cos(psi)*cos(q1)+sin(psi)*sin(q1)*sin(th)))));
C77=-c2*dq2*l1*ml2*sin(q2);
C78=-c2*l1*ml2*sin(q2)*(dphi+dq1+dq2-dpsi*sin(th));
end

function [C84, C85, C86, C87, C88] = get_C8()
C84=c2*ml2*(dq1*l1*sin(q2)+(l1*sin(q2)+L*sin(q1+q2))*(dphi- ...
  dpsi*sin(th)));
C85=(-1/2)*dpsi*(H2zz+c2^2*ml2+c2*l1*ml2*cos(q2)+c2*L*ml2*cos(q1+ ...
  q2)-H2xx*cos(2*(phi+q1+q2))+H2yy*cos(2*(phi+q1+q2))+c2^2* ...
  ml2*cos(2*(phi+q1+q2))+c2*L*ml2*cos(2*phi+q1+q2)+c2*l1*ml2*cos( ...
  2*(phi+q1)+q2))*cos(th)+dth*(c2*L*ml2*cos(phi)+c2*l1*ml2*cos( ...
  phi+q1)+(-H2xx+H2yy+c2^2*ml2)*cos(phi+q1+q2))*sin(phi+q1+q2);
C86=(1/2)*(-dth*(H2zz+c2^2*ml2+c2*l1*ml2*cos(q2)+c2*L*ml2* ...
  cos(q1+q2)-H2xx*cos(2*(phi+q1+q2))+H2yy*cos(2*(phi+q1+q2))+ ...
  c2^2*ml2*cos(2*(phi+q1+q2))+c2*L*ml2*cos(2*phi+q1+q2)+c2*l1* ...
  ml2*cos(2*(phi+q1)+q2))*cos(th)+(-2)*c2*dq1*l1*ml2*sin(q2)*sin( ...
  th)+(-2)*c2*dphi*ml2*(l1*sin(q2)+L*sin(q1+q2))*sin(th)+dpsi*(( ...
  H2xx-H2yy)*cos(2*(q1+q2))*cos(th)^2*sin(2*phi)+(H2xx- ...
  H2yy)*cos(phi)^2*cos(th)^2*sin(2*(q1+q2))+(-H2xx+H2yy)*cos( ...
  th)^2*sin(phi)^2*sin(2*(q1+q2))+(-2)*ml2*(c2*sin(q1+q2)*(sin( ...
  phi)*sin(psi)+cos(phi)*cos(psi)*sin(th))+c2*cos(q1+q2)*(-cos( ...
  phi)*sin(psi)+cos(psi)*sin(phi)*sin(th)))*(-(L+l1*cos(q1)+c2* ...
  cos(q1+q2))*(sin(phi)*sin(psi)+cos(phi)*cos(psi)*sin(th))+(l1*sin( ...
  q1)+c2*sin(q1+q2))*(-cos(phi)*sin(psi)+cos(psi)*sin(phi)*sin( ...
  th)))+(-2)*ml2*(cos(psi)*(L*sin(phi)+l1*sin(phi+q1)+c2*sin(phi+q1+ ...
  q2))-(L*cos(phi)+l1*cos(phi+q1)+c2*cos(phi+q1+q2))*sin(psi)* ...
  sin(th))*(c2*sin(q1+q2)*(-cos(psi)*sin(phi)+cos(phi)*sin(psi) ...
  *sin(th))+c2*cos(q1+q2)*(cos(phi)*cos(psi)+sin(phi)*sin(psi)*sin( ...
  th)))));
C87=c2*l1*ml2*sin(q2)*(dphi+dq1-dpsi*sin(th));
C88=0;
end

end


