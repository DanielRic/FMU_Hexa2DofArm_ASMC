(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    106335,       2595]
NotebookOptionsPosition[    103931,       2551]
NotebookOutlinePosition[    104362,       2568]
CellTagsIndexPosition[    104319,       2565]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X", "[", "t_", "]"}], ":=", " ", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{"t", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Y", "[", "t_", "]"}], ":=", " ", 
    RowBox[{"RotationMatrix", "[", 
     RowBox[{"t", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Z", "[", "t_", "]"}], ":=", " ", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{"t", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"skewToq", "[", "M_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"And", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "M", "]"}], "\[Equal]", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], ",", 
       RowBox[{"M", "\[Equal]", 
        RowBox[{"-", 
         RowBox[{"Transpose", "[", "M", "]"}]}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"skewMat", "[", "v_", "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"-", 
        RowBox[{"Part", "[", 
         RowBox[{"v", ",", " ", "3"}], "]"}]}], ",", " ", 
       RowBox[{"Part", "[", 
        RowBox[{"v", ",", " ", "2"}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Part", "[", 
        RowBox[{"v", ",", " ", "3"}], "]"}], ",", " ", "0", ",", " ", 
       RowBox[{"-", 
        RowBox[{"Part", "[", 
         RowBox[{"v", ",", " ", "1"}], "]"}]}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Part", "[", 
         RowBox[{"v", ",", " ", "2"}], "]"}]}], ",", " ", 
       RowBox[{"Part", "[", 
        RowBox[{"v", ",", " ", "1"}], "]"}], ",", " ", "0"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"myMatrix", "[", 
    RowBox[{"n_Integer", ",", "m_Integer", ",", " ", "q_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{
        RowBox[{"H", "[", "q", "]"}], ",", "i", ",", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "m"}], "}"}]}], "]"}], "//", "MatrixForm"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", " ", "=", " ", 
   RowBox[{"\[Beta]", "[", "t", "]"}]}], ";", " ", 
  RowBox[{"a", " ", "=", " ", 
   RowBox[{"\[Gamma]", "[", "t", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Phi]", "[", "t", "]"}], ",", " ", 
     RowBox[{"\[Theta]", "[", "t", "]"}], ",", " ", 
     RowBox[{"\[Psi]", "[", "t", "]"}]}], "}"}]}], ";", " ", 
  RowBox[{"\[Eta]", " ", "//", " ", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Eta]", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"\[Eta]", ",", " ", "t"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9033585034393964`*^9, 3.903358580982394*^9}, {
   3.903701828623577*^9, 3.903701848447524*^9}, {3.90370192450498*^9, 
   3.90370192739874*^9}, {3.904516118758546*^9, 3.9045161379032383`*^9}, {
   3.9052117397705965`*^9, 3.90521174046579*^9}, 3.9052129589450226`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"7b4af5fa-bb1f-4c70-8f67-b45aa8d5709d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"1.", " ", "Rotations"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"R21", " ", "=", " ", 
     RowBox[{"Z", "[", "b", "]"}]}], ";", "                          ", 
    RowBox[{"R21", " ", "//", " ", "MatrixForm"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R1a", " ", "=", " ", 
     RowBox[{"Z", "[", "a", "]"}]}], ";", "                          ", 
    RowBox[{"R1a", " ", "//", " ", "MatrixForm"}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rab", " ", "=", " ", 
     RowBox[{"Y", "[", 
      RowBox[{"Pi", "/", "2"}], "]"}]}], ";", "                  ", 
    RowBox[{"Rab", " ", "//", " ", "MatrixForm"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rb", " ", "=", " ", 
     RowBox[{
      RowBox[{"Z", "[", 
       RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], ".", 
      RowBox[{"Y", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], ".", 
      RowBox[{"X", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}]}], ";", " ", 
    RowBox[{"Rb", " ", "//", " ", "MatrixForm"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"W", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "0", ",", " ", 
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}]}], "}"}], " ", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", 
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}]}], "}"}]}], "}"}]}], 
    ";", " ", 
    RowBox[{"W", "//", "MatrixForm"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Rb", ".", "W"}], "]"}]}], ";", " ", 
    RowBox[{"A", " ", "//", " ", "MatrixForm"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.903270220381013*^9, 3.9032702492465315`*^9}, {
   3.903270280884905*^9, 3.903270293156155*^9}, {3.903312416291723*^9, 
   3.90331243713153*^9}, {3.9033125002848577`*^9, 3.9033125103441505`*^9}, {
   3.903356592214634*^9, 3.9033565971215644`*^9}, {3.903357295904789*^9, 
   3.9033573022245655`*^9}, 3.903357444724368*^9, {3.9045161061768036`*^9, 
   3.9045161067730083`*^9}, {3.9045161416381497`*^9, 
   3.9045162336951895`*^9}, {3.90451627262249*^9, 3.9045163059891925`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"567e472d-ed76-465f-af0d-10a6d5d3052d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}]},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9033573026017313`*^9, 3.9033573612510147`*^9, 3.9033586039768887`*^9, 
   3.9033586965021076`*^9, 3.903360353475339*^9, 3.903360815875819*^9, 
   3.9033610035636053`*^9, 3.9033618189176536`*^9, 3.903361853236678*^9, 
   3.9033630890629225`*^9, 3.903382404295633*^9, 3.9037017919460297`*^9, 
   3.903701930234597*^9, 3.903702123422082*^9, 3.903702250052677*^9, 
   3.90370246206457*^9, {3.9045161894703693`*^9, 3.9045162340313787`*^9}, {
   3.904516273008258*^9, 3.904516280339385*^9}, 3.904516338941469*^9, 
   3.9045179192549276`*^9, 3.9045180015715075`*^9, 3.9045180379672327`*^9, 
   3.904518451170066*^9, 3.9045185232078676`*^9, 3.904518618874968*^9, 
   3.904518674594346*^9, 3.904519145054559*^9, 3.9045196187292833`*^9, 
   3.905211742576808*^9, 3.9052120083759794`*^9, 3.9052121270491962`*^9, {
   3.9052125488321075`*^9, 3.9052125576505785`*^9}, 3.905212654830683*^9, 
   3.9052128883777113`*^9, 3.9052129624514446`*^9, 3.9052130084423275`*^9, 
   3.9052130799770293`*^9},
 CellLabel->
  "Out[14]//MatrixForm=",ExpressionUUID->"1386cc33-a136-4a39-82ea-\
482b1f51d20e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]},
     {"0", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}]},
     {"0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9033573026017313`*^9, 3.9033573612510147`*^9, 3.9033586039768887`*^9, 
   3.9033586965021076`*^9, 3.903360353475339*^9, 3.903360815875819*^9, 
   3.9033610035636053`*^9, 3.9033618189176536`*^9, 3.903361853236678*^9, 
   3.9033630890629225`*^9, 3.903382404295633*^9, 3.9037017919460297`*^9, 
   3.903701930234597*^9, 3.903702123422082*^9, 3.903702250052677*^9, 
   3.90370246206457*^9, {3.9045161894703693`*^9, 3.9045162340313787`*^9}, {
   3.904516273008258*^9, 3.904516280339385*^9}, 3.904516338941469*^9, 
   3.9045179192549276`*^9, 3.9045180015715075`*^9, 3.9045180379672327`*^9, 
   3.904518451170066*^9, 3.9045185232078676`*^9, 3.904518618874968*^9, 
   3.904518674594346*^9, 3.904519145054559*^9, 3.9045196187292833`*^9, 
   3.905211742576808*^9, 3.9052120083759794`*^9, 3.9052121270491962`*^9, {
   3.9052125488321075`*^9, 3.9052125576505785`*^9}, 3.905212654830683*^9, 
   3.9052128883777113`*^9, 3.9052129624514446`*^9, 3.9052130084423275`*^9, 
   3.9052130799860044`*^9},
 CellLabel->
  "Out[15]//MatrixForm=",ExpressionUUID->"5b0a56de-caf0-4de4-9634-\
0cb7421a936f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], "0"},
     {
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "0"},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9033573026017313`*^9, 3.9033573612510147`*^9, 3.9033586039768887`*^9, 
   3.9033586965021076`*^9, 3.903360353475339*^9, 3.903360815875819*^9, 
   3.9033610035636053`*^9, 3.9033618189176536`*^9, 3.903361853236678*^9, 
   3.9033630890629225`*^9, 3.903382404295633*^9, 3.9037017919460297`*^9, 
   3.903701930234597*^9, 3.903702123422082*^9, 3.903702250052677*^9, 
   3.90370246206457*^9, {3.9045161894703693`*^9, 3.9045162340313787`*^9}, {
   3.904516273008258*^9, 3.904516280339385*^9}, 3.904516338941469*^9, 
   3.9045179192549276`*^9, 3.9045180015715075`*^9, 3.9045180379672327`*^9, 
   3.904518451170066*^9, 3.9045185232078676`*^9, 3.904518618874968*^9, 
   3.904518674594346*^9, 3.904519145054559*^9, 3.9045196187292833`*^9, 
   3.905211742576808*^9, 3.9052120083759794`*^9, 3.9052121270491962`*^9, {
   3.9052125488321075`*^9, 3.9052125576505785`*^9}, 3.905212654830683*^9, 
   3.9052128883777113`*^9, 3.9052129624514446`*^9, 3.9052130084423275`*^9, 
   3.905213080078377*^9},
 CellLabel->
  "Out[16]//MatrixForm=",ExpressionUUID->"73c8c542-ac2b-40ee-ac0d-\
4d922c4aa64c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"1.", " ", "Translations"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"d21", " ", "=", " ", 
     RowBox[{"l2", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "b", "]"}], ",", " ", 
        RowBox[{"Sin", "[", "b", "]"}], ",", " ", "0"}], "}"}]}]}], ";", " ", 
    RowBox[{"d21", " ", "//", " ", "MatrixForm"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d1a", " ", "=", " ", 
     RowBox[{"l1", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "a", "]"}], ",", " ", 
        RowBox[{"Sin", "[", "a", "]"}], ",", " ", "0"}], "}"}]}]}], ";", " ", 
    RowBox[{"d1a", " ", "//", " ", "MatrixForm"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dab", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", 
       RowBox[{"-", "L"}]}], "}"}]}], ";", "                           ", 
    RowBox[{"dab", " ", "//", " ", "MatrixForm"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rb", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "[", "t", "]"}], ",", " ", 
       RowBox[{"y", "[", "t", "]"}], ",", " ", 
       RowBox[{"z", "[", "t", "]"}]}], "}"}]}], ";"}], "         ", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.903274028288048*^9, 3.903274031477313*^9}, {
   3.903357226399694*^9, 3.9033572468415885`*^9}, {3.9045162899665585`*^9, 
   3.9045163343906984`*^9}, {3.9045163889893165`*^9, 3.9045163925262575`*^9}, 
   3.9052117494092846`*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"9217be85-2e96-40ef-8597-c2aee3f17075"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Mapping", " ", "to", " ", "body", " ", "frame"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"wbb", " ", "=", " ", 
     RowBox[{"W", ".", "d\[Eta]"}]}], ";", " ", 
    RowBox[{"wbb", " ", "//", " ", "MatrixForm"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rffa", " ", "=", " ", 
     RowBox[{
      RowBox[{"R1a", ".", 
       RowBox[{"(", 
        RowBox[{"l2", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "b", "]"}], ",", " ", 
           RowBox[{"Sin", "[", "b", "]"}], ",", " ", "0"}], "}"}]}], ")"}]}], 
      " ", "+", " ", "d1a"}]}], ";", " ", 
    RowBox[{"rffa", "//", " ", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rffb", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Rab", ".", "rffa"}], " ", "+", "dab"}], "]"}]}], ";", " ", 
    RowBox[{"rffb", " ", "//", " ", "MatrixForm"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wffb", " ", "=", " ", 
     RowBox[{"Rab", ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"a", ",", " ", "t"}], "]"}], " ", "+", " ", 
         RowBox[{"D", "[", 
          RowBox[{"b", ",", " ", "t"}], "]"}]}]}], "}"}]}]}], ";", " ", 
    RowBox[{"wffb", " ", "//", " ", "MatrixForm"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.903270199961254*^9, 3.903270206714287*^9}, 
   3.903270302762813*^9, {3.9032737227658305`*^9, 3.903273821693331*^9}, {
   3.903273981037693*^9, 3.903273993396818*^9}, {3.9032740596698456`*^9, 
   3.9032741333043365`*^9}, {3.9032746145085845`*^9, 3.903274618445092*^9}, {
   3.9032746899950094`*^9, 3.903274727620656*^9}, {3.904516415629548*^9, 
   3.9045165995968685`*^9}, {3.905211725694889*^9, 3.9052117687700043`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"29859414-797c-44f3-926c-701f51e7ff5d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "-", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Psi]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Psi]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], " ", 
         RowBox[{
          SuperscriptBox["\[Theta]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["\[Psi]", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.903273732043337*^9, 3.903273738770381*^9}, 
   3.9032739951845584`*^9, 3.903274060722048*^9, 3.9032741336816683`*^9, {
   3.9032747038193874`*^9, 3.90327472802046*^9}, 3.9033566026396914`*^9, {
   3.903356973044976*^9, 3.903357013191017*^9}, 3.9033573614566994`*^9, 
   3.9033586041398954`*^9, 3.9033586966748133`*^9, 3.903360353570441*^9, 
   3.903360815972501*^9, 3.903361003665162*^9, 3.903361819035351*^9, 
   3.9033618533783417`*^9, 3.9033630891850185`*^9, 3.903382404443241*^9, 
   3.9037017955702057`*^9, 3.9037019334459543`*^9, 3.9037021235340014`*^9, 
   3.9037022501486163`*^9, 3.903702462440318*^9, {3.904516588112981*^9, 
   3.9045166003422894`*^9}, 3.9045179194202724`*^9, 3.9045180017774477`*^9, 
   3.9045180381633*^9, 3.9045184513667383`*^9, 3.9045185234214115`*^9, 
   3.9045186190761833`*^9, 3.904518674721259*^9, 3.9045191452126627`*^9, 
   3.904519618929717*^9, 3.9052117694888816`*^9, 3.9052120111794405`*^9, 
   3.9052121272436996`*^9, {3.905212548936558*^9, 3.9052125577999897`*^9}, 
   3.905212654986676*^9, 3.905212888569023*^9, 3.9052129659111547`*^9, 
   3.905213008572979*^9, 3.905213080186058*^9},
 CellLabel->
  "Out[21]//MatrixForm=",ExpressionUUID->"28e13791-b3f8-4fab-b93f-\
b331433ef0cf"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       RowBox[{
        RowBox[{"l1", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"l2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
           RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}]},
      {
       RowBox[{
        RowBox[{"-", "L"}], "-", 
        RowBox[{"l1", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{"l2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
           RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.903273732043337*^9, 3.903273738770381*^9}, 
   3.9032739951845584`*^9, 3.903274060722048*^9, 3.9032741336816683`*^9, {
   3.9032747038193874`*^9, 3.90327472802046*^9}, 3.9033566026396914`*^9, {
   3.903356973044976*^9, 3.903357013191017*^9}, 3.9033573614566994`*^9, 
   3.9033586041398954`*^9, 3.9033586966748133`*^9, 3.903360353570441*^9, 
   3.903360815972501*^9, 3.903361003665162*^9, 3.903361819035351*^9, 
   3.9033618533783417`*^9, 3.9033630891850185`*^9, 3.903382404443241*^9, 
   3.9037017955702057`*^9, 3.9037019334459543`*^9, 3.9037021235340014`*^9, 
   3.9037022501486163`*^9, 3.903702462440318*^9, {3.904516588112981*^9, 
   3.9045166003422894`*^9}, 3.9045179194202724`*^9, 3.9045180017774477`*^9, 
   3.9045180381633*^9, 3.9045184513667383`*^9, 3.9045185234214115`*^9, 
   3.9045186190761833`*^9, 3.904518674721259*^9, 3.9045191452126627`*^9, 
   3.904519618929717*^9, 3.9052117694888816`*^9, 3.9052120111794405`*^9, 
   3.9052121272436996`*^9, {3.905212548936558*^9, 3.9052125577999897`*^9}, 
   3.905212654986676*^9, 3.905212888569023*^9, 3.9052129659111547`*^9, 
   3.905213008572979*^9, 3.9052130802658815`*^9},
 CellLabel->
  "Out[23]//MatrixForm=",ExpressionUUID->"d25946fb-ede9-4b18-af92-\
258205b2702a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Beta]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["\[Gamma]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.903273732043337*^9, 3.903273738770381*^9}, 
   3.9032739951845584`*^9, 3.903274060722048*^9, 3.9032741336816683`*^9, {
   3.9032747038193874`*^9, 3.90327472802046*^9}, 3.9033566026396914`*^9, {
   3.903356973044976*^9, 3.903357013191017*^9}, 3.9033573614566994`*^9, 
   3.9033586041398954`*^9, 3.9033586966748133`*^9, 3.903360353570441*^9, 
   3.903360815972501*^9, 3.903361003665162*^9, 3.903361819035351*^9, 
   3.9033618533783417`*^9, 3.9033630891850185`*^9, 3.903382404443241*^9, 
   3.9037017955702057`*^9, 3.9037019334459543`*^9, 3.9037021235340014`*^9, 
   3.9037022501486163`*^9, 3.903702462440318*^9, {3.904516588112981*^9, 
   3.9045166003422894`*^9}, 3.9045179194202724`*^9, 3.9045180017774477`*^9, 
   3.9045180381633*^9, 3.9045184513667383`*^9, 3.9045185234214115`*^9, 
   3.9045186190761833`*^9, 3.904518674721259*^9, 3.9045191452126627`*^9, 
   3.904519618929717*^9, 3.9052117694888816`*^9, 3.9052120111794405`*^9, 
   3.9052121272436996`*^9, {3.905212548936558*^9, 3.9052125577999897`*^9}, 
   3.905212654986676*^9, 3.905212888569023*^9, 3.9052129659111547`*^9, 
   3.905213008572979*^9, 3.9052130802753477`*^9},
 CellLabel->
  "Out[24]//MatrixForm=",ExpressionUUID->"3a4a68b5-a10a-48bf-a6e1-\
a3b0a5885bb3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Jacobians", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"q", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "b"}], "}"}]}], ";", " ", 
    RowBox[{"dq", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{"q", ",", " ", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vffb", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{"rffb", ",", " ", "t"}], "]"}]}], ";", " ", 
    RowBox[{"vffb", " ", "//", " ", "MatrixForm"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Jvffb", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"l1", " ", 
           RowBox[{"Cos", "[", "a", "]"}]}], " ", "+", " ", 
          RowBox[{"l2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"a", " ", "+", " ", "b"}], "]"}]}]}], ",", " ", 
         RowBox[{"l2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"a", " ", "+", " ", "b"}], "]"}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"l1", " ", 
           RowBox[{"Sin", "[", "a", "]"}]}], " ", "+", " ", 
          RowBox[{"l2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"a", "+", "b"}], "]"}]}]}], ",", " ", 
         RowBox[{"l2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"a", " ", "+", " ", "b"}], "]"}]}]}], "}"}]}], "}"}]}], 
    ";", " ", 
    RowBox[{"Jvffb", " ", "//", " ", "MatrixForm"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"vffb", " ", "-", " ", 
      RowBox[{"Jvffb", ".", "dq"}]}], "]"}], " ", "//", " ", "MatrixForm"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Jwffb", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0"}], "}"}]}], "}"}]}], ";", " ", 
    RowBox[{"Jwffb", " ", "//", " ", "MatrixForm"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"Jwffb", ".", "dq"}], "-", "wffb"}], "]"}], " ", "//", " ", 
    "MatrixForm"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.903274207959844*^9, 3.9032742129176006`*^9}, {
  3.9032750069937425`*^9, 3.903275026654755*^9}, {3.9032753510299377`*^9, 
  3.903275448115122*^9}, {3.903275509459999*^9, 3.903275539758374*^9}, {
  3.9032774612462673`*^9, 3.903277614014551*^9}, {3.9032777595394006`*^9, 
  3.903277871466844*^9}, {3.90451664831015*^9, 3.9045167417656574`*^9}, {
  3.905211784868885*^9, 3.905211833410183*^9}, {3.9052119734411135`*^9, 
  3.9052119845376472`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"da9ae7ca-b651-4a9d-8d30-6e993ba316a0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {
      RowBox[{
       RowBox[{"l1", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"l2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
          RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{"l2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
         RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"l1", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"l2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
          RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{"l2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
         RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9032775207124157`*^9, 3.9032776146369796`*^9}, {
   3.9032777625086284`*^9, 3.9032778242045326`*^9}, {3.9032778549949903`*^9, 
   3.9032778723154984`*^9}, 3.903356602757976*^9, {3.903356973178172*^9, 
   3.903357013349004*^9}, 3.9033573615731115`*^9, 3.9033586043097887`*^9, 
   3.9033586968929806`*^9, 3.9033603537333717`*^9, 3.9033608160757647`*^9, 
   3.90336100375972*^9, 3.903361819205292*^9, 3.903361853574703*^9, 
   3.9033630893873005`*^9, 3.9033824045928783`*^9, 3.903701809550167*^9, 
   3.9037019356044235`*^9, 3.903702123646557*^9, 3.9037022502445555`*^9, 
   3.903702462608206*^9, {3.904516711464446*^9, 3.9045167421299033`*^9}, 
   3.9045179195764437`*^9, 3.9045180019210873`*^9, 3.904518038346216*^9, 
   3.904518451493046*^9, 3.9045185236073837`*^9, 3.9045186192247334`*^9, 
   3.9045186748393784`*^9, 3.9045191453877573`*^9, 3.904519619094489*^9, {
   3.9052118272576275`*^9, 3.90521183404885*^9}, 3.905212012927823*^9, 
   3.905212127347806*^9, {3.905212549030079*^9, 3.905212557901965*^9}, 
   3.9052126550969105`*^9, 3.905212888761079*^9, 3.905212967490572*^9, 
   3.905213008682432*^9, 3.9052130803632984`*^9},
 CellLabel->
  "Out[27]//MatrixForm=",ExpressionUUID->"7f4ddc3b-c664-4dce-8b44-\
0ca5c5ab184e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9032775207124157`*^9, 3.9032776146369796`*^9}, {
   3.9032777625086284`*^9, 3.9032778242045326`*^9}, {3.9032778549949903`*^9, 
   3.9032778723154984`*^9}, 3.903356602757976*^9, {3.903356973178172*^9, 
   3.903357013349004*^9}, 3.9033573615731115`*^9, 3.9033586043097887`*^9, 
   3.9033586968929806`*^9, 3.9033603537333717`*^9, 3.9033608160757647`*^9, 
   3.90336100375972*^9, 3.903361819205292*^9, 3.903361853574703*^9, 
   3.9033630893873005`*^9, 3.9033824045928783`*^9, 3.903701809550167*^9, 
   3.9037019356044235`*^9, 3.903702123646557*^9, 3.9037022502445555`*^9, 
   3.903702462608206*^9, {3.904516711464446*^9, 3.9045167421299033`*^9}, 
   3.9045179195764437`*^9, 3.9045180019210873`*^9, 3.904518038346216*^9, 
   3.904518451493046*^9, 3.9045185236073837`*^9, 3.9045186192247334`*^9, 
   3.9045186748393784`*^9, 3.9045191453877573`*^9, 3.904519619094489*^9, {
   3.9052118272576275`*^9, 3.90521183404885*^9}, 3.905212012927823*^9, 
   3.905212127347806*^9, {3.905212549030079*^9, 3.905212557901965*^9}, 
   3.9052126550969105`*^9, 3.905212888761079*^9, 3.905212967490572*^9, 
   3.905213008682432*^9, 3.9052130803692617`*^9},
 CellLabel->
  "Out[28]//MatrixForm=",ExpressionUUID->"c1af6aaf-cfe2-4aa0-acfb-\
ac4ffca75199"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1"},
     {"0", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9032775207124157`*^9, 3.9032776146369796`*^9}, {
   3.9032777625086284`*^9, 3.9032778242045326`*^9}, {3.9032778549949903`*^9, 
   3.9032778723154984`*^9}, 3.903356602757976*^9, {3.903356973178172*^9, 
   3.903357013349004*^9}, 3.9033573615731115`*^9, 3.9033586043097887`*^9, 
   3.9033586968929806`*^9, 3.9033603537333717`*^9, 3.9033608160757647`*^9, 
   3.90336100375972*^9, 3.903361819205292*^9, 3.903361853574703*^9, 
   3.9033630893873005`*^9, 3.9033824045928783`*^9, 3.903701809550167*^9, 
   3.9037019356044235`*^9, 3.903702123646557*^9, 3.9037022502445555`*^9, 
   3.903702462608206*^9, {3.904516711464446*^9, 3.9045167421299033`*^9}, 
   3.9045179195764437`*^9, 3.9045180019210873`*^9, 3.904518038346216*^9, 
   3.904518451493046*^9, 3.9045185236073837`*^9, 3.9045186192247334`*^9, 
   3.9045186748393784`*^9, 3.9045191453877573`*^9, 3.904519619094489*^9, {
   3.9052118272576275`*^9, 3.90521183404885*^9}, 3.905212012927823*^9, 
   3.905212127347806*^9, {3.905212549030079*^9, 3.905212557901965*^9}, 
   3.9052126550969105`*^9, 3.905212888761079*^9, 3.905212967490572*^9, 
   3.905213008682432*^9, 3.9052130803762465`*^9},
 CellLabel->
  "Out[29]//MatrixForm=",ExpressionUUID->"3b87dd8b-0a18-4c57-867b-\
34fcb5e5ea7c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9032775207124157`*^9, 3.9032776146369796`*^9}, {
   3.9032777625086284`*^9, 3.9032778242045326`*^9}, {3.9032778549949903`*^9, 
   3.9032778723154984`*^9}, 3.903356602757976*^9, {3.903356973178172*^9, 
   3.903357013349004*^9}, 3.9033573615731115`*^9, 3.9033586043097887`*^9, 
   3.9033586968929806`*^9, 3.9033603537333717`*^9, 3.9033608160757647`*^9, 
   3.90336100375972*^9, 3.903361819205292*^9, 3.903361853574703*^9, 
   3.9033630893873005`*^9, 3.9033824045928783`*^9, 3.903701809550167*^9, 
   3.9037019356044235`*^9, 3.903702123646557*^9, 3.9037022502445555`*^9, 
   3.903702462608206*^9, {3.904516711464446*^9, 3.9045167421299033`*^9}, 
   3.9045179195764437`*^9, 3.9045180019210873`*^9, 3.904518038346216*^9, 
   3.904518451493046*^9, 3.9045185236073837`*^9, 3.9045186192247334`*^9, 
   3.9045186748393784`*^9, 3.9045191453877573`*^9, 3.904519619094489*^9, {
   3.9052118272576275`*^9, 3.90521183404885*^9}, 3.905212012927823*^9, 
   3.905212127347806*^9, {3.905212549030079*^9, 3.905212557901965*^9}, 
   3.9052126550969105`*^9, 3.905212888761079*^9, 3.905212967490572*^9, 
   3.905213008682432*^9, 3.9052130803832264`*^9},
 CellLabel->
  "Out[30]//MatrixForm=",ExpressionUUID->"70ad0160-a1fa-413c-9d1a-\
5aa767e38aea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Inertia", " ", "Matrix"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Zero3by3", " ", "=", "  ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", " ", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sff", " ", "=", 
     RowBox[{"skewMat", "[", 
      RowBox[{"Rb", ".", "rffb"}], "]"}]}], ";", " ", 
    RowBox[{"Sff", "//", " ", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Jvf", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", " ", 
        RowBox[{"-", 
         RowBox[{"Sff", ".", "A"}]}], ",", " ", 
        RowBox[{"Rb", ".", "Jvffb"}], ",", " ", "2"}], "]"}], "]"}]}], ";", 
    " ", 
    RowBox[{"Jvf", " ", "//", " ", "MatrixForm"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Jwf", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Join", "[", 
       RowBox[{"Zero3by3", ",", " ", "A", ",", " ", 
        RowBox[{"Rb", ".", "Jwffb"}], ",", " ", "2"}], "]"}], "]"}]}], ";", 
    RowBox[{"Jwf", " ", "//", " ", "MatrixForm"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Jf", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Join", "[", 
       RowBox[{"Jvf", ",", " ", "Jwf", ",", "1"}], "]"}], "]"}]}], ";", " ", 
    RowBox[{"Jf", " ", "//", " ", "MatrixForm"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9033578272410755`*^9, 3.9033579429922085`*^9}, {
   3.90335798401705*^9, 3.9033579916869087`*^9}, {3.903358589231143*^9, 
   3.9033588283916273`*^9}, {3.903358872909643*^9, 3.9033592066480055`*^9}, {
   3.903359268901372*^9, 3.903359286019603*^9}, {3.903359417396223*^9, 
   3.9033594237881036`*^9}, {3.903359481948148*^9, 3.9033594824452057`*^9}, {
   3.9033595968200593`*^9, 3.903359706636575*^9}, {3.903359744347894*^9, 
   3.9033602535725117`*^9}, 3.9033603832681055`*^9, {3.903360927641323*^9, 
   3.903361000146572*^9}, {3.903382366878788*^9, 3.903382370755558*^9}, {
   3.903701871730406*^9, 3.9037019129541416`*^9}, {3.904516963565061*^9, 
   3.9045169949719734`*^9}, {3.9045173036680574`*^9, 3.904517321693748*^9}, {
   3.905211919122002*^9, 3.905212097105892*^9}, {3.9052128284983873`*^9, 
   3.9052128286066923`*^9}, {3.9052129514427557`*^9, 
   3.9052129516070943`*^9}, {3.9052129849925013`*^9, 3.905212985174904*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"5fe66ab8-363c-4eda-8c56-e0f97a11fe79"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "+", 
             RowBox[{"l1", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"l2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
                RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"l1", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"l2", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
                RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l1", "+", 
             RowBox[{"l2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Beta]", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "L"}], "+", 
             RowBox[{"l2", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Beta]", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"l2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Beta]", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"l1", "+", 
                RowBox[{"l2", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Beta]", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
         ")"}]}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"L", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"l1", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Gamma]", "[", "t", "]"}], "+", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"l2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
            RowBox[{"\[Gamma]", "[", "t", "]"}], "+", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"L", "+", 
           RowBox[{"l1", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"l2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
              RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l1", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
             RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l1", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
             RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l1", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
             RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"l2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
          RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"l2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
          RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}]},
     {"0", "1", "0", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"L", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"l1", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"\[Gamma]", "[", "t", "]"}], "+", 
             RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
             RowBox[{"\[Gamma]", "[", "t", "]"}], "+", 
             RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"l1", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}], "+", 
              RowBox[{"l2", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
                 RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "+", 
             RowBox[{"l1", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"l2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
                RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
         ")"}]}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"L", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"l1", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Gamma]", "[", "t", "]"}], "+", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"l2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
            RowBox[{"\[Gamma]", "[", "t", "]"}], "+", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l1", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
             RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "+", 
          RowBox[{"l1", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
             RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l1", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
             RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l1", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
             RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"l2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
          RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"l2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
          RowBox[{"\[Gamma]", "[", "t", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}]},
     {"0", "0", "1", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"L", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"l1", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"\[Gamma]", "[", "t", "]"}], "+", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"l2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
            RowBox[{"\[Gamma]", "[", "t", "]"}], "+", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"L", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"l1", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Gamma]", "[", "t", "]"}], "+", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"l2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
            RowBox[{"\[Gamma]", "[", "t", "]"}], "+", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "0", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"l1", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"\[Gamma]", "[", "t", "]"}], "+", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"l2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
            RowBox[{"\[Gamma]", "[", "t", "]"}], "+", 
            RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], 
      RowBox[{"l2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"\[Beta]", "[", "t", "]"}], "+", 
         RowBox[{"\[Gamma]", "[", "t", "]"}], "+", 
         RowBox[{"\[Phi]", "[", "t", "]"}]}], "]"}]}]},
     {"0", "0", "0", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], "0", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]},
     {"0", "0", "0", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Psi]", "[", "t", "]"}], "]"}], "0", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Psi]", "[", "t", "]"}], "]"}]}]},
     {"0", "0", "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "0", "1", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.903359934786213*^9, 3.903360098752884*^9, {3.903360140338401*^9, 
   3.9033601514091177`*^9}, {3.9033602037162204`*^9, 3.903360254216324*^9}, {
   3.903360343480235*^9, 3.9033603641613665`*^9}, 3.9033605108478594`*^9, 
   3.9033608300970383`*^9, {3.9033609390462637`*^9, 3.9033609682664833`*^9}, 
   3.9033610131242433`*^9, 3.9033618288082695`*^9, 3.903361864090663*^9, 
   3.903363099774495*^9, 3.903382474415306*^9, 3.903702096850563*^9, 
   3.9037021376315107`*^9, 3.903702263756235*^9, 3.903702583158146*^9, 
   3.904517368783492*^9, 3.904517934097945*^9, 3.9045180163521943`*^9, 
   3.904518051952659*^9, 3.904518466467684*^9, 3.9045185381835423`*^9, 
   3.9045186334505033`*^9, 3.9045186883582544`*^9, 3.9045191596594114`*^9, 
   3.904519634570609*^9, 3.905212093286024*^9, 3.905212127763694*^9, {
   3.9052125491694536`*^9, 3.9052125580684724`*^9}, 3.9052126552929115`*^9, 
   3.905212896125493*^9, {3.905212969198004*^9, 3.9052130089027433`*^9}, 
   3.9052130869907045`*^9},
 CellLabel->
  "Out[35]//MatrixForm=",ExpressionUUID->"dc85b85f-0afe-4b89-8b4d-\
44c9c501fa02"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dr", " ", "=", " ", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Get", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"dr", ",", " ", "\"\<\\\\ToMatlab\\\\ToMatlab.m\>\""}], "]"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jf", " ", "=", " ", 
   RowBox[{"Jf", " ", "/.", " ", 
    RowBox[{
     RowBox[{"\[Gamma]", "[", "t", "]"}], " ", "\[Rule]", " ", "q1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jf", " ", "=", " ", 
   RowBox[{"Jf", " ", "/.", " ", 
    RowBox[{
     RowBox[{"\[Beta]", "[", "t", "]"}], " ", "\[Rule]", " ", "q2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jf", " ", "=", " ", 
   RowBox[{"Jf", " ", "/.", " ", 
    RowBox[{
     RowBox[{"x", "[", "t", "]"}], " ", "\[Rule]", " ", "x"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jf", " ", "=", " ", 
   RowBox[{"Jf", " ", "/.", " ", 
    RowBox[{
     RowBox[{"y", "[", "t", "]"}], " ", "\[Rule]", " ", "y"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jf", " ", "=", " ", 
   RowBox[{"Jf", " ", "/.", " ", 
    RowBox[{
     RowBox[{"z", "[", "t", "]"}], " ", "\[Rule]", " ", "z"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jf", " ", "=", " ", 
   RowBox[{"Jf", " ", "/.", " ", 
    RowBox[{
     RowBox[{"\[Phi]", "[", "t", "]"}], " ", "\[Rule]", " ", "phi"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jf", " ", "=", " ", 
   RowBox[{"Jf", " ", "/.", " ", 
    RowBox[{
     RowBox[{"\[Theta]", "[", "t", "]"}], " ", "\[Rule]", " ", "th"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Jf", " ", "=", " ", 
    RowBox[{"Jf", " ", "/.", " ", 
     RowBox[{
      RowBox[{"\[Psi]", "[", "t", "]"}], " ", "\[Rule]", " ", "psi"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jf", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"f", "=", 
  RowBox[{"OpenWrite", "[", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"dr", ",", " ", "\"\<\\\\MATLAB Expressions\\\\Jf.m\>\""}], "]"}],
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"Jf", ",", "f", ",", " ", "\"\<Jf\>\""}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.905212240831271*^9, 3.905212267418175*^9}, {
   3.9052125164555745`*^9, 3.9052125409282637`*^9}, {3.9052126233050036`*^9, 
   3.9052126509862947`*^9}, {3.905212818161968*^9, 3.9052128211754627`*^9}, 
   3.9052130391211967`*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"751cc9f7-391b-4974-a57a-2f00fb6a3abb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", "phi", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", "psi", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"l1", " ", 
              RowBox[{"Sin", "[", "q1", "]"}]}], "+", 
             RowBox[{"l2", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"q1", "+", "q2"}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "psi", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"L", "+", 
             RowBox[{"l1", " ", 
              RowBox[{"Cos", "[", "q1", "]"}]}], "+", 
             RowBox[{"l2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"q1", "+", "q2"}], "]"}]}]}], ")"}], " ", 
           RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "phi", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", "psi", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "L"}], "+", 
             RowBox[{"l2", " ", 
              RowBox[{"Sin", "[", "q1", "]"}], " ", 
              RowBox[{"Sin", "[", "q2", "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "psi", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"l1", "+", 
             RowBox[{"l2", " ", 
              RowBox[{"Cos", "[", "q2", "]"}]}]}], ")"}], " ", 
           RowBox[{"Sin", "[", "q1", "]"}], " ", 
           RowBox[{"Sin", "[", "th", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "q1", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"l1", "+", 
                 RowBox[{"l2", " ", 
                  RowBox[{"Cos", "[", "q2", "]"}]}]}], ")"}]}], " ", 
              RowBox[{"Sin", "[", "psi", "]"}]}], "+", 
             RowBox[{"l2", " ", 
              RowBox[{"Cos", "[", "psi", "]"}], " ", 
              RowBox[{"Sin", "[", "q2", "]"}], " ", 
              RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "psi", "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"L", " ", 
          RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
         RowBox[{"l1", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"phi", "+", "q1"}], "]"}]}], "+", 
         RowBox[{"l2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"phi", "+", "q1", "+", "q2"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "th", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"L", "+", 
           RowBox[{"l1", " ", 
            RowBox[{"Cos", "[", "q1", "]"}]}], "+", 
           RowBox[{"l2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"q1", "+", "q2"}], "]"}]}]}], ")"}]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "psi", "]"}], " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", "phi", "]"}], " ", 
           RowBox[{"Sin", "[", "psi", "]"}], " ", 
           RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l1", " ", 
           RowBox[{"Sin", "[", "q1", "]"}]}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"q1", "+", "q2"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "phi", "]"}], " ", 
           RowBox[{"Cos", "[", "psi", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", "phi", "]"}], " ", 
           RowBox[{"Sin", "[", "psi", "]"}], " ", 
           RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l1", " ", 
           RowBox[{"Sin", "[", "q1", "]"}]}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"q1", "+", "q2"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", "phi", "]"}], " ", 
           RowBox[{"Sin", "[", "psi", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "phi", "]"}], " ", 
           RowBox[{"Cos", "[", "psi", "]"}], " ", 
           RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l1", " ", 
           RowBox[{"Cos", "[", "q1", "]"}]}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"q1", "+", "q2"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "phi", "]"}]}], " ", 
           RowBox[{"Sin", "[", "psi", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "psi", "]"}], " ", 
           RowBox[{"Sin", "[", "phi", "]"}], " ", 
           RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"l2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q1", "+", "q2"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", "phi", "]"}], " ", 
           RowBox[{"Sin", "[", "psi", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "phi", "]"}], " ", 
           RowBox[{"Cos", "[", "psi", "]"}], " ", 
           RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"l2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q1", "+", "q2"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "phi", "]"}]}], " ", 
           RowBox[{"Sin", "[", "psi", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "psi", "]"}], " ", 
           RowBox[{"Sin", "[", "phi", "]"}], " ", 
           RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}]}]},
     {"0", "1", "0", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "psi", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"L", " ", 
           RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
          RowBox[{"l1", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "+", "q1"}], "]"}]}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "+", "q1", "+", "q2"}], "]"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "th", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "th", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"L", "+", 
             RowBox[{"l1", " ", 
              RowBox[{"Cos", "[", "q1", "]"}]}], "+", 
             RowBox[{"l2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"q1", "+", "q2"}], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sin", "[", "phi", "]"}], " ", 
              RowBox[{"Sin", "[", "psi", "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", "phi", "]"}], " ", 
              RowBox[{"Cos", "[", "psi", "]"}], " ", 
              RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"l1", " ", 
              RowBox[{"Sin", "[", "q1", "]"}]}], "+", 
             RowBox[{"l2", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"q1", "+", "q2"}], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Cos", "[", "phi", "]"}]}], " ", 
              RowBox[{"Sin", "[", "psi", "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", "psi", "]"}], " ", 
              RowBox[{"Sin", "[", "phi", "]"}], " ", 
              RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"L", " ", 
           RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
          RowBox[{"l1", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "+", "q1"}], "]"}]}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"phi", "+", "q1", "+", "q2"}], "]"}]}]}], ")"}]}], " ", 
       RowBox[{"Cos", "[", "th", "]"}], " ", 
       RowBox[{"Sin", "[", "psi", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"L", "+", 
           RowBox[{"l1", " ", 
            RowBox[{"Cos", "[", "q1", "]"}]}], "+", 
           RowBox[{"l2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"q1", "+", "q2"}], "]"}]}]}], ")"}]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", "phi", "]"}], " ", 
           RowBox[{"Sin", "[", "psi", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "phi", "]"}], " ", 
           RowBox[{"Cos", "[", "psi", "]"}], " ", 
           RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l1", " ", 
           RowBox[{"Sin", "[", "q1", "]"}]}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"q1", "+", "q2"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "phi", "]"}]}], " ", 
           RowBox[{"Sin", "[", "psi", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "psi", "]"}], " ", 
           RowBox[{"Sin", "[", "phi", "]"}], " ", 
           RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l1", " ", 
           RowBox[{"Sin", "[", "q1", "]"}]}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"q1", "+", "q2"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "psi", "]"}]}], " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "phi", "]"}], " ", 
           RowBox[{"Sin", "[", "psi", "]"}], " ", 
           RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l1", " ", 
           RowBox[{"Cos", "[", "q1", "]"}]}], "+", 
          RowBox[{"l2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"q1", "+", "q2"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "phi", "]"}], " ", 
           RowBox[{"Cos", "[", "psi", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", "phi", "]"}], " ", 
           RowBox[{"Sin", "[", "psi", "]"}], " ", 
           RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"l2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q1", "+", "q2"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "psi", "]"}]}], " ", 
           RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "phi", "]"}], " ", 
           RowBox[{"Sin", "[", "psi", "]"}], " ", 
           RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"l2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q1", "+", "q2"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "phi", "]"}], " ", 
           RowBox[{"Cos", "[", "psi", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", "phi", "]"}], " ", 
           RowBox[{"Sin", "[", "psi", "]"}], " ", 
           RowBox[{"Sin", "[", "th", "]"}]}]}], ")"}]}]}]},
     {"0", "0", "1", 
      RowBox[{
       RowBox[{"Cos", "[", "th", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"L", " ", 
          RowBox[{"Sin", "[", "phi", "]"}]}], "+", 
         RowBox[{"l1", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"phi", "+", "q1"}], "]"}]}], "+", 
         RowBox[{"l2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"phi", "+", "q1", "+", "q2"}], "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"L", " ", 
          RowBox[{"Cos", "[", "phi", "]"}]}], "+", 
         RowBox[{"l1", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"phi", "+", "q1"}], "]"}]}], "+", 
         RowBox[{"l2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"phi", "+", "q1", "+", "q2"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", "th", "]"}]}], "0", 
      RowBox[{
       RowBox[{"Cos", "[", "th", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"l1", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"phi", "+", "q1"}], "]"}]}], "+", 
         RowBox[{"l2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"phi", "+", "q1", "+", "q2"}], "]"}]}]}], ")"}]}], 
      RowBox[{"l2", " ", 
       RowBox[{"Cos", "[", "th", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"phi", "+", "q1", "+", "q2"}], "]"}]}]},
     {"0", "0", "0", 
      RowBox[{
       RowBox[{"Cos", "[", "psi", "]"}], " ", 
       RowBox[{"Cos", "[", "th", "]"}]}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "psi", "]"}]}], "0", 
      RowBox[{
       RowBox[{"Cos", "[", "psi", "]"}], " ", 
       RowBox[{"Cos", "[", "th", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "psi", "]"}], " ", 
       RowBox[{"Cos", "[", "th", "]"}]}]},
     {"0", "0", "0", 
      RowBox[{
       RowBox[{"Cos", "[", "th", "]"}], " ", 
       RowBox[{"Sin", "[", "psi", "]"}]}], 
      RowBox[{"Cos", "[", "psi", "]"}], "0", 
      RowBox[{
       RowBox[{"Cos", "[", "th", "]"}], " ", 
       RowBox[{"Sin", "[", "psi", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "th", "]"}], " ", 
       RowBox[{"Sin", "[", "psi", "]"}]}]},
     {"0", "0", "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "th", "]"}]}], "0", "1", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "th", "]"}]}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "th", "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9052125493256645`*^9, 3.9052125582195654`*^9}, 
   3.9052126554574327`*^9, 3.9052128964455676`*^9, {3.905212996330031*^9, 
   3.905213009074897*^9}, 3.9052130872321353`*^9},
 CellLabel->
  "Out[46]//MatrixForm=",ExpressionUUID->"60dd5342-ae66-4d0d-ba2f-\
2a4eb2d28b3c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["OutputStream",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquarePlusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[{
              Thickness[0.0016806722689075631`], {
               FaceForm[{
                 GrayLevel[0.93], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               RGBColor[0.699951, 0.699951, 0.699951], 
               Opacity[1.], 
               JoinForm[{ElisionsDump`Miter, 10.}], 
               
               JoinedCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               FaceForm[{
                 RGBColor[0.5, 0.5, 0.5], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                0, 1, 0}, {1, 3, 3}, {1, 3, 3}}}, {{{3.52539, 
                1.0035199999999997`}, {2.5250000000000004`, 
                1.0035199999999997`}, {1.6828099999999997`, 
                1.0035199999999997`}, {0.9999999999999999, 
                1.6863299999999997`}, {0.9999999999999999, 
                2.5285199999999994`}, {0.9999999999999999, 
                23.474999999999998`}, {0.9999999999999999, 
                24.317199999999996`}, {1.6828099999999997`, 
                24.999999999999996`}, {2.5250000000000004`, 
                24.999999999999996`}, {3.52539, 24.999999999999996`}, {
                3.52539, 24.999999999999993`}, {5.523440000000001, 
                22.421099999999996`}, {5.523440000000001, 13.0039}, {
                5.523440000000001, 3.5867199999999992`}, {3.52539, 
                1.0035199999999997`}, {3.52539, 1.0035199999999997`}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}}}, {{{22.4977, 12.9016}, {
                17.740599999999997`, 16.8398}, {17.740599999999997`, 
                14.856599999999998`}, {19.980900000000002`, 
                12.947299999999997`}, {17.740599999999997`, 
                10.946100000000001`}, {17.740599999999997`, 8.96289}, {
                22.4977, 12.9016}}}]}, {
               FaceForm[{
                 RGBColor[
                 0.46093800000000007`, 0.46093800000000007`, 
                  0.46093800000000007`], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}}}, {{{9.202339999999998, 12.8969}, {9.202339999999998, 
                12.335499999999998`}, {8.747660000000002, 
                11.880899999999999`}, {8.186329999999998, 
                11.880899999999999`}, {7.624999999999999, 
                11.880899999999999`}, {7.169920000000001, 
                12.335499999999998`}, {7.169920000000001, 12.8969}, {
                7.169920000000001, 13.458200000000003`}, {7.624999999999999, 
                13.9133}, {8.186329999999998, 13.9133}, {8.747660000000002, 
                13.9133}, {9.202339999999998, 13.458200000000003`}, {
                9.202339999999998, 12.8969}}}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}}}, {{{12.6227, 12.8969}, {12.6227, 12.335499999999998`}, {
                12.167599999999998`, 11.880899999999999`}, {
                11.606200000000001`, 11.880899999999999`}, {11.0449, 
                11.880899999999999`}, {10.589799999999999`, 
                12.335499999999998`}, {10.589799999999999`, 12.8969}, {
                10.589799999999999`, 13.458200000000003`}, {11.0449, 
                13.9133}, {11.606200000000001`, 13.9133}, {
                12.167599999999998`, 13.9133}, {12.6227, 
                13.458200000000003`}, {12.6227, 12.8969}}}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}}}, {{{16.042600000000004`, 12.8969}, {16.042600000000004`, 
                12.335499999999998`}, {15.587499999999999`, 
                11.880899999999999`}, {15.026199999999998`, 
                11.880899999999999`}, {14.464799999999997`, 
                11.880899999999999`}, {14.010199999999998`, 
                12.335499999999998`}, {14.010199999999998`, 12.8969}, {
                14.010199999999998`, 13.458200000000003`}, {
                14.464799999999997`, 13.9133}, {15.026199999999998`, 
                13.9133}, {15.587499999999999`, 13.9133}, {
                16.042600000000004`, 13.458200000000003`}, {
                16.042600000000004`, 12.8969}}}]}}, AspectRatio -> 1, Axes -> 
             False, Background -> GrayLevel[0.5], Frame -> True, FrameStyle -> 
             Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]], FrameTicks -> None, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Name: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  StyleBox[
                   PaneBox[
                   "\"Jf.m\"", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                   False], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Unique ID: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquareMinusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[{
              Thickness[0.0016806722689075631`], {
               FaceForm[{
                 GrayLevel[0.93], 
                 Opacity[1.]}], 
               FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               RGBColor[0.699951, 0.699951, 0.699951], 
               Opacity[1.], 
               JoinForm[{ElisionsDump`Miter, 10.}], 
               
               JoinedCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               FaceForm[{
                 RGBColor[0.5, 0.5, 0.5], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                0, 1, 0}, {1, 3, 3}, {1, 3, 3}}}, {{{3.52539, 
                1.0035199999999997`}, {2.5250000000000004`, 
                1.0035199999999997`}, {1.6828099999999997`, 
                1.0035199999999997`}, {0.9999999999999999, 
                1.6863299999999997`}, {0.9999999999999999, 
                2.5285199999999994`}, {0.9999999999999999, 
                23.474999999999998`}, {0.9999999999999999, 
                24.317199999999996`}, {1.6828099999999997`, 
                24.999999999999996`}, {2.5250000000000004`, 
                24.999999999999996`}, {3.52539, 24.999999999999996`}, {
                3.52539, 24.999999999999993`}, {5.523440000000001, 
                22.421099999999996`}, {5.523440000000001, 13.0039}, {
                5.523440000000001, 3.5867199999999992`}, {3.52539, 
                1.0035199999999997`}, {3.52539, 1.0035199999999997`}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}}}, {{{22.4977, 12.9016}, {
                17.740599999999997`, 16.8398}, {17.740599999999997`, 
                14.856599999999998`}, {19.980900000000002`, 
                12.947299999999997`}, {17.740599999999997`, 
                10.946100000000001`}, {17.740599999999997`, 8.96289}, {
                22.4977, 12.9016}}}]}, {
               FaceForm[{
                 RGBColor[
                 0.46093800000000007`, 0.46093800000000007`, 
                  0.46093800000000007`], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}}}, {{{9.202339999999998, 12.8969}, {9.202339999999998, 
                12.335499999999998`}, {8.747660000000002, 
                11.880899999999999`}, {8.186329999999998, 
                11.880899999999999`}, {7.624999999999999, 
                11.880899999999999`}, {7.169920000000001, 
                12.335499999999998`}, {7.169920000000001, 12.8969}, {
                7.169920000000001, 13.458200000000003`}, {7.624999999999999, 
                13.9133}, {8.186329999999998, 13.9133}, {8.747660000000002, 
                13.9133}, {9.202339999999998, 13.458200000000003`}, {
                9.202339999999998, 12.8969}}}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}}}, {{{12.6227, 12.8969}, {12.6227, 12.335499999999998`}, {
                12.167599999999998`, 11.880899999999999`}, {
                11.606200000000001`, 11.880899999999999`}, {11.0449, 
                11.880899999999999`}, {10.589799999999999`, 
                12.335499999999998`}, {10.589799999999999`, 12.8969}, {
                10.589799999999999`, 13.458200000000003`}, {11.0449, 
                13.9133}, {11.606200000000001`, 13.9133}, {
                12.167599999999998`, 13.9133}, {12.6227, 
                13.458200000000003`}, {12.6227, 12.8969}}}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}}}, {{{16.042600000000004`, 12.8969}, {16.042600000000004`, 
                12.335499999999998`}, {15.587499999999999`, 
                11.880899999999999`}, {15.026199999999998`, 
                11.880899999999999`}, {14.464799999999997`, 
                11.880899999999999`}, {14.010199999999998`, 
                12.335499999999998`}, {14.010199999999998`, 12.8969}, {
                14.010199999999998`, 13.458200000000003`}, {
                14.464799999999997`, 13.9133}, {15.026199999999998`, 
                13.9133}, {15.587499999999999`, 13.9133}, {
                16.042600000000004`, 13.458200000000003`}, {
                16.042600000000004`, 12.8969}}}]}}, AspectRatio -> 1, Axes -> 
             False, Background -> GrayLevel[0.5], Frame -> True, FrameStyle -> 
             Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]], FrameTicks -> None, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Name: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  PaneBox[
                  "\"C:\\\\Users\\\\Dell\\\\Documents\\\\GitHub\\\\Hexa\\\\\
Model Matrices\\\\\\\\MATLAB Expressions\\\\Jf.m\"", 
                   ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                   Baseline, ContentPadding -> False, FrameMargins -> 0, 
                   StripOnInput -> True], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Unique ID: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Binary: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["False", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Open: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  DynamicBox[
                   ToBoxes[Options[
                    OutputStream[
                    "C:\\Users\\Dell\\Documents\\GitHub\\Hexa\\Model Matrices\
\\\\MATLAB Expressions\\Jf.m", 3]] =!= {}, StandardForm], UpdateInterval -> 
                   1], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Encoding: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Automatic", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Format: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["InputForm", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Page width: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["78", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Number marks: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Automatic", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  OutputStream[
  "C:\\Users\\Dell\\Documents\\GitHub\\Hexa\\Model Matrices\\\\MATLAB \
Expressions\\Jf.m", 3],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.9052125493256645`*^9, 3.9052125582195654`*^9}, 
   3.9052126554574327`*^9, 3.9052128964455676`*^9, {3.905212996330031*^9, 
   3.905213009074897*^9}, 3.9052130873049393`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"2c773810-a410-43e1-a5d3-905431d05427"]
}, Open  ]]
},
WindowSize->{1584, 801},
WindowMargins->{{Automatic, -1600}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"80d198f5-c430-4054-94ec-4c2955944b43"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4079, 119, 207, "Input",ExpressionUUID->"7b4af5fa-bb1f-4c70-8f67-b45aa8d5709d"],
Cell[CellGroupData[{
Cell[4662, 143, 3089, 75, 171, "Input",ExpressionUUID->"567e472d-ed76-465f-af0d-10a6d5d3052d"],
Cell[7754, 220, 4348, 110, 76, "Output",ExpressionUUID->"1386cc33-a136-4a39-82ea-482b1f51d20e"],
Cell[12105, 332, 2236, 52, 76, "Output",ExpressionUUID->"5b0a56de-caf0-4de4-9634-0cb7421a936f"],
Cell[14344, 386, 2234, 52, 64, "Output",ExpressionUUID->"73c8c542-ac2b-40ee-ac0d-4d922c4aa64c"]
}, Open  ]],
Cell[16593, 441, 1657, 42, 117, "Input",ExpressionUUID->"9217be85-2e96-40ef-8597-c2aee3f17075"],
Cell[CellGroupData[{
Cell[18275, 487, 2019, 48, 153, "Input",ExpressionUUID->"29859414-797c-44f3-926c-701f51e7ff5d"],
Cell[20297, 537, 3299, 78, 76, "Output",ExpressionUUID->"28e13791-b3f8-4fab-b93f-b331433ef0cf"],
Cell[23599, 617, 2462, 56, 74, "Output",ExpressionUUID->"d25946fb-ede9-4b18-af92-258205b2702a"],
Cell[26064, 675, 2037, 44, 60, "Output",ExpressionUUID->"3a4a68b5-a10a-48bf-a6e1-a3b0a5885bb3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28138, 724, 3010, 76, 189, "Input",ExpressionUUID->"da9ae7ca-b651-4a9d-8d30-6e993ba316a0"],
Cell[31151, 802, 2727, 63, 74, "Output",ExpressionUUID->"7f4ddc3b-c664-4dce-8b44-0ca5c5ab184e"],
Cell[33881, 867, 1785, 37, 70, "Output",ExpressionUUID->"c1af6aaf-cfe2-4aa0-acfb-ac4ffca75199"],
Cell[35669, 906, 1749, 35, 70, "Output",ExpressionUUID->"3b87dd8b-0a18-4c57-867b-34fcb5e5ea7c"],
Cell[37421, 943, 1785, 37, 58, "Output",ExpressionUUID->"70ad0160-a1fa-413c-9d1a-5aa767e38aea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39243, 985, 2732, 59, 225, "Input",ExpressionUUID->"5fe66ab8-363c-4eda-8c56-e0f97a11fe79"],
Cell[41978, 1046, 24456, 636, 129, "Output",ExpressionUUID->"dc85b85f-0afe-4b89-8b4d-44c9c501fa02"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66471, 1687, 2736, 74, 333, "Input",ExpressionUUID->"751cc9f7-391b-4974-a57a-2f00fb6a3abb"],
Cell[69210, 1763, 15374, 428, 129, "Output",ExpressionUUID->"60dd5342-ae66-4d0d-ba2f-2a4eb2d28b3c"],
Cell[84587, 2193, 19328, 355, 63, "Output",ExpressionUUID->"2c773810-a410-43e1-a5d3-905431d05427"]
}, Open  ]]
}
]
*)

