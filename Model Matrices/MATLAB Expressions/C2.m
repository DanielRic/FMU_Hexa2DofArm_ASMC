C24=(-1).*dq1.*cos(psi).*((c1.*ml1+l1.*ml2).*sin(phi+q1)+c2.*ml2.*sin(phi+ ...
  q1+q2))+dth.*cos(th).*sin(psi).*(L.*(ml1+ml2).*sin(phi)+(c1.*ml1+l1.* ...
  ml2).*sin(phi+q1)+c2.*ml2.*sin(phi+q1+q2))+(-1/4).*c2.*dq2.*ml2.*(cos( ...
  phi+(-1).*psi+q1+q2+(-1).*th)+(-1).*cos(phi+psi+q1+q2+(-1).*th)+(-1).* ...
  cos(phi+(-1).*psi+q1+q2+th)+cos(phi+psi+q1+q2+th)+2.*sin(phi+(-1).*psi+ ...
  q1+q2)+2.*sin(phi+psi+q1+q2))+dq1.*((c1.*ml1+l1.*ml2).*cos(phi+q1)+c2.* ...
  ml2.*cos(phi+q1+q2)).*sin(psi).*sin(th)+dphi.*((-1).*cos(psi).*(L.*(ml1+ ...
  ml2).*sin(phi)+(c1.*ml1+l1.*ml2).*sin(phi+q1)+c2.*ml2.*sin(phi+q1+q2))+( ...
  L.*(ml1+ml2).*cos(phi)+(c1.*ml1+l1.*ml2).*cos(phi+q1)+c2.*ml2.*cos(phi+ ...
  q1+q2)).*sin(psi).*sin(th))+dpsi.*(sin(phi).*(sin(psi).*((c1.*ml1+l1.* ...
  ml2).*sin(q1)+c2.*ml2.*sin(q1+q2))+cos(psi).*(L.*(ml1+ml2)+(c1.*ml1+l1.* ...
  ml2).*cos(q1)+c2.*ml2.*cos(q1+q2)).*sin(th))+cos(phi).*((-1).*(L.*(ml1+ ...
  ml2)+(c1.*ml1+l1.*ml2).*cos(q1)+c2.*ml2.*cos(q1+q2)).*sin(psi)+cos(psi) ...
  .*((c1.*ml1+l1.*ml2).*sin(q1)+c2.*ml2.*sin(q1+q2)).*sin(th)));
C25=(-1).*dpsi.*cos(psi).*(L.*(ml1+ml2).*cos(phi)+(c1.*ml1+l1.*ml2).*cos( ...
  phi+q1)+c2.*ml2.*cos(phi+q1+q2)).*cos(th)+c2.*dq2.*ml2.*cos(th).*sin( ...
  psi).*sin(phi+q1+q2)+dq1.*cos(th).*sin(psi).*((c1.*ml1+l1.*ml2).*sin( ...
  phi+q1)+c2.*ml2.*sin(phi+q1+q2))+dphi.*cos(th).*sin(psi).*(L.*(ml1+ml2) ...
  .*sin(phi)+(c1.*ml1+l1.*ml2).*sin(phi+q1)+c2.*ml2.*sin(phi+q1+q2))+dth.* ...
  (L.*(ml1+ml2).*cos(phi)+(c1.*ml1+l1.*ml2).*cos(phi+q1)+c2.*ml2.*cos(phi+ ...
  q1+q2)).*sin(psi).*sin(th);
C26=(1/2).*((-2).*cos(psi).*(dth.*(c1.*ml1+l1.*ml2).*cos(phi+q1).*cos(th)+ ...
  c2.*dth.*ml2.*cos(phi+q1+q2).*cos(th)+sin(phi).*(L.*(ml1+ml2).*(dpsi+( ...
  -1).*dphi.*sin(th))+(c1.*ml1+l1.*ml2).*cos(q1).*(dpsi+(-1).*(dphi+dq1).* ...
  sin(th))+c2.*ml2.*cos(q1+q2).*(dpsi+(-1).*(dphi+dq1+dq2).*sin(th))))+( ...
  -1).*cos(phi).*(2.*cos(psi).*(dth.*L.*(ml1+ml2).*cos(th)+(c1.*ml1+l1.* ...
  ml2).*sin(q1).*(dpsi+(-1).*(dphi+dq1).*sin(th))+c2.*ml2.*sin(q1+q2).*( ...
  dpsi+(-1).*(dphi+dq1+dq2).*sin(th)))+sin(psi).*(2.*L.*(ml1+ml2).*(dphi+( ...
  -1).*dpsi.*sin(th))+(-1/2).*c2.*ml2.*cos(q1+q2).*((-3).*dphi+(-4).*dq1+( ...
  -4).*dq2+dphi.*cos(2.*th)+4.*dpsi.*sin(th))+cos(q1).*(2.*c1.*(dphi+dq1) ...
  .*ml1+(dphi+2.*dq1).*l1.*ml2+(-2).*dpsi.*(c1.*ml1+l1.*ml2).*sin(th)+ ...
  dphi.*l1.*ml2.*sin(th).^2)))+sin(psi).*((-1).*dphi.*l1.*ml2.*cos(phi+q1) ...
  .*cos(th).^2+(-1).*c2.*dphi.*ml2.*cos(phi+q1+q2).*cos(th).^2+sin(phi).*( ...
  c2.*ml2.*sin(q1+q2).*(dphi+2.*(dq1+dq2)+(-2).*dpsi.*sin(th)+dphi.*sin( ...
  th).^2)+sin(q1).*(2.*c1.*(dphi+dq1).*ml1+(dphi+2.*dq1).*l1.*ml2+(-2).* ...
  dpsi.*(c1.*ml1+l1.*ml2).*sin(th)+dphi.*l1.*ml2.*sin(th).^2))));
C27=(-1).*dphi.*cos(psi).*((c1.*ml1+l1.*ml2).*sin(phi+q1)+c2.*ml2.*sin(phi+ ...
  q1+q2))+dth.*cos(th).*sin(psi).*((c1.*ml1+l1.*ml2).*sin(phi+q1)+c2.* ...
  ml2.*sin(phi+q1+q2))+dphi.*((c1.*ml1+l1.*ml2).*cos(phi+q1)+c2.*ml2.*cos( ...
  phi+q1+q2)).*sin(psi).*sin(th)+(-1).*c2.*dq2.*ml2.*(cos(psi).*sin(phi+ ...
  q1+q2)+(-1).*cos(phi+q1+q2).*sin(psi).*sin(th))+dq1.*((-1).*cos(psi).*(( ...
  c1.*ml1+l1.*ml2).*sin(phi+q1)+c2.*ml2.*sin(phi+q1+q2))+((c1.*ml1+l1.* ...
  ml2).*cos(phi+q1)+c2.*ml2.*cos(phi+q1+q2)).*sin(psi).*sin(th))+dpsi.*( ...
  sin(phi).*(sin(psi).*((c1.*ml1+l1.*ml2).*sin(q1)+c2.*ml2.*sin(q1+q2))+ ...
  cos(psi).*((c1.*ml1+l1.*ml2).*cos(q1)+c2.*ml2.*cos(q1+q2)).*sin(th))+ ...
  cos(phi).*((-1).*((c1.*ml1+l1.*ml2).*cos(q1)+c2.*ml2.*cos(q1+q2)).*sin( ...
  psi)+cos(psi).*((c1.*ml1+l1.*ml2).*sin(q1)+c2.*ml2.*sin(q1+q2)).*sin(th) ...
  ));
C28=(-1/2).*c2.*ml2.*(2.*cos(psi).*sin(phi+q1+q2).*(dphi+dq1+dq2+(-1).* ...
  dpsi.*sin(th))+sin(psi).*(2.*dpsi.*cos(phi+q1+q2)+(dphi+dq1+dq2+(-1).* ...
  dth).*sin(phi+q1+q2+(-1).*th)+(-1).*(dphi+dq1+dq2+dth).*sin(phi+q1+q2+ ...
  th)));
